<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
       "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Cookie parameter test</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8" />
<meta http-equiv="Content-Style-Type" content="text/css" />
</head>
<body>

<h2>Cookie parameter test</h2>
<p> 
Write cookies... 
</p>

<?cob PERFORM LIST-COOKIE-STR ?>

<p> 
<form action="/cgi-bin/0030_ck_param_2" method="post" accept-charset="utf-8">
  <input type="submit" value="Send">
</form>
</p>

</body>
</html>

<?cob-ws
 01 WS-IND                             PIC 9(4). 
 01 WS-COOKIE-TAB. 
  02 WS-COOKIE-TAB-LINES               OCCURS 10 TIMES.
   03 WS-COOKIE-LINE                   PIC X(256).
?>

<?cob 
*> Implement this section, if you want to set a cookie.
*>------------------------------------------------------------------------------
 HTM2COB-SET-COOKIE SECTION.
*>------------------------------------------------------------------------------

*>  test 1
    INITIALIZE LNK-HTM2COB-SET-COOKIE
    SET V-SET OF LNK-COOKIE-FUNC OF LNK-HTM2COB-SET-COOKIE TO TRUE
    MOVE "NAME01"        TO LNK-COOKIE-NAME  OF LNK-HTM2COB-SET-COOKIE
    MOVE "VALUE01"       TO LNK-COOKIE-VALUE OF LNK-HTM2COB-SET-COOKIE
    CALL "HTM2COB-SET-COOKIE" USING LNK-HTM2COB-SET-COOKIE END-CALL
    DISPLAY FUNCTION TRIM(LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE) END-DISPLAY
    MOVE LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE TO WS-COOKIE-LINE(1)

*>  test 2
    INITIALIZE LNK-HTM2COB-SET-COOKIE
    SET V-SET OF LNK-COOKIE-FUNC OF LNK-HTM2COB-SET-COOKIE TO TRUE
    MOVE "NAME02"        TO LNK-COOKIE-NAME  OF LNK-HTM2COB-SET-COOKIE
    MOVE "VALUE02"       TO LNK-COOKIE-VALUE OF LNK-HTM2COB-SET-COOKIE
    MOVE 1800            TO LNK-MAX-AGE-SEC  OF LNK-HTM2COB-SET-COOKIE
    CALL "HTM2COB-SET-COOKIE" USING LNK-HTM2COB-SET-COOKIE END-CALL
    DISPLAY FUNCTION TRIM(LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE) END-DISPLAY
    MOVE LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE TO WS-COOKIE-LINE(2)
    
*>  test 3
    INITIALIZE LNK-HTM2COB-SET-COOKIE
    SET V-SET OF LNK-COOKIE-FUNC OF LNK-HTM2COB-SET-COOKIE TO TRUE
    MOVE "NAME03"        TO LNK-COOKIE-NAME  OF LNK-HTM2COB-SET-COOKIE
    MOVE "VALUE03"       TO LNK-COOKIE-VALUE OF LNK-HTM2COB-SET-COOKIE
    MOVE 1800            TO LNK-MAX-AGE-SEC  OF LNK-HTM2COB-SET-COOKIE
    MOVE "localhost"     TO LNK-DOMAIN-VALUE OF LNK-HTM2COB-SET-COOKIE
    CALL "HTM2COB-SET-COOKIE" USING LNK-HTM2COB-SET-COOKIE END-CALL
    DISPLAY FUNCTION TRIM(LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE) END-DISPLAY
    MOVE LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE TO WS-COOKIE-LINE(3)

*>  test 4
    INITIALIZE LNK-HTM2COB-SET-COOKIE
    SET V-SET OF LNK-COOKIE-FUNC OF LNK-HTM2COB-SET-COOKIE TO TRUE
    MOVE "NAME04"        TO LNK-COOKIE-NAME  OF LNK-HTM2COB-SET-COOKIE
    MOVE "VALUE04"       TO LNK-COOKIE-VALUE OF LNK-HTM2COB-SET-COOKIE
    MOVE 1800            TO LNK-MAX-AGE-SEC  OF LNK-HTM2COB-SET-COOKIE
    MOVE "localhost"     TO LNK-DOMAIN-VALUE OF LNK-HTM2COB-SET-COOKIE
    MOVE "/"             TO LNK-PATH-VALUE   OF LNK-HTM2COB-SET-COOKIE
    CALL "HTM2COB-SET-COOKIE" USING LNK-HTM2COB-SET-COOKIE END-CALL
    DISPLAY FUNCTION TRIM(LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE) END-DISPLAY
    MOVE LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE TO WS-COOKIE-LINE(4)

*>  test 5
    INITIALIZE LNK-HTM2COB-SET-COOKIE
    SET V-SET OF LNK-COOKIE-FUNC OF LNK-HTM2COB-SET-COOKIE TO TRUE
    MOVE "NAME05"        TO LNK-COOKIE-NAME  OF LNK-HTM2COB-SET-COOKIE
    MOVE "VALUE05"       TO LNK-COOKIE-VALUE OF LNK-HTM2COB-SET-COOKIE
    MOVE 1800            TO LNK-MAX-AGE-SEC  OF LNK-HTM2COB-SET-COOKIE
    MOVE "localhost"     TO LNK-DOMAIN-VALUE OF LNK-HTM2COB-SET-COOKIE
    MOVE "/"             TO LNK-PATH-VALUE   OF LNK-HTM2COB-SET-COOKIE
    SET V-YES OF LNK-HTTPONLY-FLAG OF LNK-HTM2COB-SET-COOKIE TO TRUE
    CALL "HTM2COB-SET-COOKIE" USING LNK-HTM2COB-SET-COOKIE END-CALL
    DISPLAY FUNCTION TRIM(LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE) END-DISPLAY
    MOVE LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE TO WS-COOKIE-LINE(5)

*>  test 6
    INITIALIZE LNK-HTM2COB-SET-COOKIE
    SET V-SET OF LNK-COOKIE-FUNC OF LNK-HTM2COB-SET-COOKIE TO TRUE
    MOVE "NAME06"        TO LNK-COOKIE-NAME  OF LNK-HTM2COB-SET-COOKIE
    MOVE "VALUE06"       TO LNK-COOKIE-VALUE OF LNK-HTM2COB-SET-COOKIE
    MOVE 1800            TO LNK-MAX-AGE-SEC  OF LNK-HTM2COB-SET-COOKIE
    MOVE "localhost"     TO LNK-DOMAIN-VALUE OF LNK-HTM2COB-SET-COOKIE
    MOVE "/"             TO LNK-PATH-VALUE   OF LNK-HTM2COB-SET-COOKIE
    SET V-YES OF LNK-HTTPONLY-FLAG OF LNK-HTM2COB-SET-COOKIE TO TRUE
    SET V-YES-LAX OF LNK-SAMESITE-FLAG OF LNK-HTM2COB-SET-COOKIE TO TRUE
    CALL "HTM2COB-SET-COOKIE" USING LNK-HTM2COB-SET-COOKIE END-CALL
    DISPLAY FUNCTION TRIM(LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE) END-DISPLAY
    MOVE LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE TO WS-COOKIE-LINE(6)

*>  test 7
    INITIALIZE LNK-HTM2COB-SET-COOKIE
    SET V-SET OF LNK-COOKIE-FUNC OF LNK-HTM2COB-SET-COOKIE TO TRUE
    MOVE "NAME07"        TO LNK-COOKIE-NAME  OF LNK-HTM2COB-SET-COOKIE
    MOVE "VALUE07"       TO LNK-COOKIE-VALUE OF LNK-HTM2COB-SET-COOKIE
    MOVE 1800            TO LNK-MAX-AGE-SEC  OF LNK-HTM2COB-SET-COOKIE
    MOVE "localhost"     TO LNK-DOMAIN-VALUE OF LNK-HTM2COB-SET-COOKIE
    MOVE "/"             TO LNK-PATH-VALUE   OF LNK-HTM2COB-SET-COOKIE
    SET V-YES OF LNK-HTTPONLY-FLAG OF LNK-HTM2COB-SET-COOKIE TO TRUE
    SET V-YES-STRICT OF LNK-SAMESITE-FLAG OF LNK-HTM2COB-SET-COOKIE TO TRUE
    CALL "HTM2COB-SET-COOKIE" USING LNK-HTM2COB-SET-COOKIE END-CALL
    *> The last DISPLAY in this section is always with "WITH NO ADVANCING"
    DISPLAY FUNCTION TRIM(LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE) WITH NO ADVANCING END-DISPLAY
    MOVE LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE TO WS-COOKIE-LINE(7)

*>  test 8
    INITIALIZE LNK-HTM2COB-SET-COOKIE
    SET V-SET OF LNK-COOKIE-FUNC OF LNK-HTM2COB-SET-COOKIE TO TRUE
    MOVE "NAME08"        TO LNK-COOKIE-NAME  OF LNK-HTM2COB-SET-COOKIE
    MOVE "VALUE08"       TO LNK-COOKIE-VALUE OF LNK-HTM2COB-SET-COOKIE
    MOVE 1800            TO LNK-MAX-AGE-SEC  OF LNK-HTM2COB-SET-COOKIE
    MOVE "localhost"     TO LNK-DOMAIN-VALUE OF LNK-HTM2COB-SET-COOKIE
    MOVE "/"             TO LNK-PATH-VALUE   OF LNK-HTM2COB-SET-COOKIE
    SET V-YES OF LNK-HTTPONLY-FLAG OF LNK-HTM2COB-SET-COOKIE TO TRUE
    SET V-YES OF LNK-SECURE-FLAG OF LNK-HTM2COB-SET-COOKIE TO TRUE
    CALL "HTM2COB-SET-COOKIE" USING LNK-HTM2COB-SET-COOKIE END-CALL
    DISPLAY FUNCTION TRIM(LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE) END-DISPLAY
    MOVE LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE TO WS-COOKIE-LINE(8)

*>  test 9
    INITIALIZE LNK-HTM2COB-SET-COOKIE
    SET V-SET OF LNK-COOKIE-FUNC OF LNK-HTM2COB-SET-COOKIE TO TRUE
    MOVE "NAME09"        TO LNK-COOKIE-NAME  OF LNK-HTM2COB-SET-COOKIE
    MOVE "VALUE09"       TO LNK-COOKIE-VALUE OF LNK-HTM2COB-SET-COOKIE
    MOVE 1800            TO LNK-MAX-AGE-SEC  OF LNK-HTM2COB-SET-COOKIE
    MOVE "localhost"     TO LNK-DOMAIN-VALUE OF LNK-HTM2COB-SET-COOKIE
    MOVE "/"             TO LNK-PATH-VALUE   OF LNK-HTM2COB-SET-COOKIE
    SET V-YES OF LNK-HTTPONLY-FLAG OF LNK-HTM2COB-SET-COOKIE TO TRUE
    SET V-YES-LAX OF LNK-SAMESITE-FLAG OF LNK-HTM2COB-SET-COOKIE TO TRUE
    SET V-YES OF LNK-SECURE-FLAG OF LNK-HTM2COB-SET-COOKIE TO TRUE
    CALL "HTM2COB-SET-COOKIE" USING LNK-HTM2COB-SET-COOKIE END-CALL
    DISPLAY FUNCTION TRIM(LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE) END-DISPLAY
    MOVE LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE TO WS-COOKIE-LINE(9)

*>  test 10
    INITIALIZE LNK-HTM2COB-SET-COOKIE
    SET V-SET OF LNK-COOKIE-FUNC OF LNK-HTM2COB-SET-COOKIE TO TRUE
    MOVE "NAME10"        TO LNK-COOKIE-NAME  OF LNK-HTM2COB-SET-COOKIE
    MOVE "VALUE10"       TO LNK-COOKIE-VALUE OF LNK-HTM2COB-SET-COOKIE
    MOVE 1800            TO LNK-MAX-AGE-SEC  OF LNK-HTM2COB-SET-COOKIE
    MOVE "localhost"     TO LNK-DOMAIN-VALUE OF LNK-HTM2COB-SET-COOKIE
    MOVE "/"             TO LNK-PATH-VALUE   OF LNK-HTM2COB-SET-COOKIE
    SET V-YES OF LNK-HTTPONLY-FLAG OF LNK-HTM2COB-SET-COOKIE TO TRUE
    SET V-YES-STRICT OF LNK-SAMESITE-FLAG OF LNK-HTM2COB-SET-COOKIE TO TRUE
    SET V-YES OF LNK-SECURE-FLAG OF LNK-HTM2COB-SET-COOKIE TO TRUE
    CALL "HTM2COB-SET-COOKIE" USING LNK-HTM2COB-SET-COOKIE END-CALL
    *> The last DISPLAY in this section is always with "WITH NO ADVANCING"
    DISPLAY FUNCTION TRIM(LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE) WITH NO ADVANCING END-DISPLAY
    MOVE LNK-COOKIE-STR OF LNK-HTM2COB-SET-COOKIE TO WS-COOKIE-LINE(10)

    .
    EXIT SECTION .
    
*>------------------------------------------------------------------------------
 LIST-COOKIE-STR SECTION.
*>------------------------------------------------------------------------------
 
    PERFORM VARYING WS-IND FROM 1 BY 1
            UNTIL WS-IND > 10
       DISPLAY WS-COOKIE-LINE(WS-IND) "<BR>" END-DISPLAY
    END-PERFORM

    .	
    EXIT SECTION .
?>


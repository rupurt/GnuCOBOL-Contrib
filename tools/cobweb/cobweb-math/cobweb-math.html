<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.12: http://docutils.sourceforge.net/" />
<title>cobweb-math</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7614 2013-02-21 15:55:51Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="cobweb-math">
<h1 class="title">cobweb-math</h1>

<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#introduction" id="id1">Introduction</a><ul>
<li><a class="reference internal" href="#repository" id="id2">Repository</a></li>
<li><a class="reference internal" href="#copybook" id="id3">Copybook</a></li>
<li><a class="reference internal" href="#libmatheval" id="id4">libmatheval</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tectonics" id="id5">Tectonics</a></li>
<li><a class="reference internal" href="#usage" id="id6">Usage</a></li>
<li><a class="reference internal" href="#source" id="id7">Source</a><ul>
<li><a class="reference internal" href="#makefile" id="id8">Makefile</a></li>
<li><a class="reference internal" href="#cobweb-math-cob" id="id9">cobweb-math.cob</a></li>
<li><a class="reference internal" href="#cobweb-math-cpy" id="id10">cobweb-math.cpy</a></li>
<li><a class="reference internal" href="#wrapmath-c" id="id11">wrapmath.c</a></li>
<li><a class="reference internal" href="#cobweb-math-demo-cob" id="id12">cobweb-math-demo.cob</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h1><a class="toc-backref" href="#id1">Introduction</a></h1>
<p>cobweb-math, a mathematical equation evaluator</p>
<p>Accepts equations from a character field and a table of variable values
and creates an evaluator, using <tt class="docutils literal">libmatheval</tt> a GNU project.</p>
<p>The basic user function repository wraps <tt class="docutils literal">libmatheval</tt> for <em>somewhat</em>
easy use from GnuCOBOL programs.</p>
<p>Inputs and return values are <tt class="docutils literal"><span class="pre">float-long</span></tt> (C <tt class="docutils literal">double</tt>) type.</p>
<div class="section" id="repository">
<h2><a class="toc-backref" href="#id2">Repository</a></h2>
<p>Functions include:</p>
<ul class="simple">
<li>create-equation(equation, &quot;options&quot;) to evaluator-record</li>
<li>evaluate-equation(evaluator, variable-count, names, values) to answer</li>
<li>destroy-equation(evaluator-record) to extraneous</li>
</ul>
<p>Options to <tt class="docutils literal"><span class="pre">create-equation</span></tt> include <em>derivative</em> and <em>variables</em> and
can be used to create a first order derivative from the equation and/or
return the list of variable names used in the equation.  Upto 16 named
variables are supported by <tt class="docutils literal"><span class="pre">cobweb-math</span></tt>.  Options are passed as a
character field, separated by commas.</p>
<p>Values are held in a table of <tt class="docutils literal"><span class="pre">float-long</span></tt>, upto 16, corresponding to
the names used, first name encounterd in the equation is 1, next is 2,
and so on.  Convenience functions exist for equations that use</p>
<p><tt class="docutils literal">x</tt>, <tt class="docutils literal">y</tt>, and <tt class="docutils literal">z</tt> as the variable names.</p>
<p>Convenience functions include:</p>
<ul class="simple">
<li>evaluate-math(calculation) to answer  (for use as a calculator)</li>
<li>evaluate-x(evaluator, x) to answer</li>
<li>evaluate-xy(evaluator, x, y) to answer</li>
<li>evaluate-xyz(evaluator, x, y, z) to answer</li>
</ul>
</div>
<div class="section" id="copybook">
<h2><a class="toc-backref" href="#id3">Copybook</a></h2>
<p>There is a small <tt class="docutils literal"><span class="pre">cobweb-math.cpy</span></tt> copybook that ships with
<tt class="docutils literal"><span class="pre">cobweb-math</span></tt>, that defines the structure of the <tt class="docutils literal"><span class="pre">evaluator-record</span></tt>.</p>
<p>It requires a working storage name prefix change before use.</p>
<pre class="code cobolfree literal-block">
<span class="keyword pseudo">COPY</span> <span class="name variable">cobweb-math</span> <span class="keyword pseudo">REPLACING </span><span class="operator">==</span><span class="punctuation">:</span><span class="name variable">tag</span><span class="punctuation">:</span><span class="operator">==</span> <span class="keyword pseudo">BY </span><span class="operator">==</span><span class="name variable">user-prefix</span><span class="operator">==</span><span class="punctuation">.</span>
</pre>
<p>Where <tt class="docutils literal"><span class="pre">user-prefix</span></tt> is developer choice.</p>
</div>
<div class="section" id="libmatheval">
<h2><a class="toc-backref" href="#id4">libmatheval</a></h2>
<p>The GNU <tt class="docutils literal">libmatheval</tt> library supports:</p>
<ul>
<li><dl class="first docutils">
<dt>Constants:</dt>
<dd><ul class="first last simple">
<li>e, log2e, log10e, ln2, ln10, pi, pi_2,</li>
<li>pi_4, 1_pi, 2_pi, 2_sqrtpi, sqrt2, sqrt1_2</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Elementary Functions:</dt>
<dd><ul class="first last simple">
<li>exp(x), log, sqrt, sin, cos, tan, cot, sec</li>
<li>csc, acsc, sinh, cosh, tanh, coth, sech</li>
<li>csch, asinh, acosh, atanh, acoth, asech</li>
<li>acsch. abs, step, delta, nandelta, erf</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Basic arthimetic:</dt>
<dd><ul class="first last simple">
<li>(negation), +, -, * , /, ^, (, and )</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
</div>
<div class="section" id="tectonics">
<h1><a class="toc-backref" href="#id5">Tectonics</a></h1>
<p>Requires:</p>
<p><tt class="docutils literal">libmatheval</tt>, <tt class="docutils literal"><span class="pre">libmatheval-dev</span></tt>,
<tt class="docutils literal">libreadline</tt> and <tt class="docutils literal"><span class="pre">libreadline-dev</span></tt></p>
<pre class="literal-block">
prompt$ cobc -bd cobweb-math.cob wrapmath.c -lmatheval -lreadline
prompt$ cobc -x user-program.cob -l:cobweb-math.so -L.
</pre>
</div>
<div class="section" id="usage">
<h1><a class="toc-backref" href="#id6">Usage</a></h1>
<pre class="literal-block">
prompt$ cobcrun cobweb-math help|demo|repository|[calc]
</pre>
<p><tt class="docutils literal">calc</tt> is the default top level option, and will display a small
calculator Read-Evaluate-Print-Loop, suitable for basic math or single
variable equations.  The only supported variable for the small <tt class="docutils literal">calc</tt>
engine is <tt class="docutils literal">x</tt>.</p>
<p>See <a class="reference internal" href="#cobweb-math-demo-cob">cobweb-math-demo.cob</a> for an example.  And the <tt class="docutils literal">calc</tt>
engine inside <tt class="docutils literal"><span class="pre">cobweb-math.cob</span></tt> itself for more usage hints.</p>
</div>
<div class="section" id="source">
<h1><a class="toc-backref" href="#id7">Source</a></h1>
<div class="section" id="makefile">
<h2><a class="toc-backref" href="#id8">Makefile</a></h2>
<pre class="code make literal-block">
<span class="name variable"></span><span class="comment"># make cobweb-math with libmatheval and libreadline
</span><span class="name variable">.RECIPEPREFIX</span> <span class="operator">=</span> &gt;

<span class="name function">.PHONY</span><span class="operator">:</span> <span class="name">all</span> <span class="name">clean</span> <span class="name">doc</span>

<span class="name function">all</span><span class="operator">:</span> <span class="name">cobweb</span>-<span class="name">math</span>.<span class="name">so</span> <span class="name">cobweb</span>-<span class="name">math</span>-<span class="name">demo</span>

<span class="name function">cobweb-math.so</span><span class="operator">:</span> <span class="name">cobweb</span>-<span class="name">math</span>.<span class="name">cob</span> <span class="name">wrapmath</span>.<span class="name">c</span>
<span class="error">&gt;</span> <span class="error">cobc</span> <span class="error">-bvgd</span> <span class="error">cobweb-math.cob</span> <span class="error">wrapmath.c</span> <span class="error">-lmatheval</span> <span class="error">-lreadline</span>

<span class="name function">cobweb-math-demo</span><span class="operator">:</span> <span class="name">cobweb</span>-<span class="name">math</span>-<span class="name">demo</span>.<span class="name">cob</span> <span class="name">cobweb</span>-<span class="name">math</span>.<span class="name">so</span>
<span class="name function">&gt; LD_RUN_PATH=. cobc -xj cobweb-math-demo.cob -l</span><span class="operator">:</span><span class="name">cobweb</span>-<span class="name">math</span>.<span class="name">so</span> -<span class="name">L</span>.

<span class="name function">cobweb-math-demo.out</span><span class="operator">:</span> <span class="name">cobweb</span>-<span class="name">math</span>-<span class="name">demo</span>
<span class="error">&gt;</span> <span class="error">./cobweb-math-demo</span> <span class="error">&gt;cobweb-math-demo.out</span>

<span class="name function">cobweb-math.html</span><span class="operator">:</span> <span class="name">cobweb</span>-<span class="name">math</span>.<span class="name">cob</span> <span class="name">wrapmath</span>.<span class="name">c</span> <span class="name">cobweb</span>-<span class="name">math</span>-<span class="name">demo</span>.<span class="name">cob</span> \
    <span class="name">cobweb</span>-<span class="name">math</span>.<span class="name">cpy</span>  <span class="name">Makefile</span> <span class="name">cobweb</span>-<span class="name">math</span>-<span class="name">demo</span>.<span class="name">out</span>
<span class="name function">doc</span><span class="operator">:</span> <span class="name">cobweb</span>-<span class="name">math</span>.<span class="name">html</span>
<span class="name function">&gt; sed '</span><span class="operator">:</span><span class="name">loop</span>;/!<span class="name">doc</span>-<span class="name">marker</span>!/{<span class="name">d</span>};<span class="name">N</span>;<span class="name">b</span> <span class="name">loop</span>' <span class="name">cobweb</span>-<span class="name">math</span>.<span class="name">cob</span> <span class="punctuation">|</span> <span class="name">sed</span> '$${/^$$/<span class="name">d</span>;}' \
<span class="punctuation">|</span> <span class="name">sed</span> '$$<span class="name">d</span>' <span class="punctuation">|</span> <span class="name">rst</span>2<span class="name">html</span> &gt;<span class="name">cobweb</span>-<span class="name">math</span>.<span class="name">html</span>

<span class="name function">callmath</span><span class="operator">:</span> <span class="name">callmath</span>.<span class="name">cob</span> <span class="name">wrapmath</span>.<span class="name">c</span>
<span class="error">&gt;</span> <span class="error">cobc</span> <span class="error">-xjd</span> <span class="error">callmath.cob</span> <span class="error">wrapmath.c</span> <span class="error">-lmatheval</span>

<span class="name function">clean</span><span class="operator">:</span>
<span class="error">&gt;</span> <span class="error">-rm</span> <span class="error">cobweb-math.c.*</span> <span class="error">cobweb-math.c</span> <span class="error">cobweb-math.i</span> <span class="error">cobweb-math.so</span>
</pre>
</div>
<div class="section" id="cobweb-math-cob">
<h2><a class="toc-backref" href="#id9">cobweb-math.cob</a></h2>
<pre class="code cobolfree literal-block">
<span class="name variable">GCobol</span> <span class="operator">&gt;&gt;</span><span class="keyword pseudo">SOURCE</span> <span class="keyword pseudo">FORMAT</span> <span class="keyword pseudo">IS</span> <span class="keyword reserved">FREE
</span><span class="operator">&gt;&gt;</span><span class="keyword reserved">IF</span> <span class="name variable">docpass</span> <span class="operator word">NOT</span> <span class="name variable">DEFINED</span>
      <span class="comment">*&gt; ***************************************************************
</span>      <span class="comment">*&gt;****J* gnucobol/cobweb-math
</span>      <span class="comment">*&gt; AUTHOR
</span>      <span class="comment">*&gt;   Brian Tiffin
</span>      <span class="comment">*&gt; DATE
</span>      <span class="comment">*&gt;   20160721  Modified: 2016-07-23/17:09-0400
</span>      <span class="comment">*&gt; LICENSE
</span>      <span class="comment">*&gt;   Copyright 2016 Brian Tiffin
</span>      <span class="comment">*&gt;   GNU Lesser General Public License, LGPL, 3.0 (or superior)
</span>      <span class="comment">*&gt; PURPOSE
</span>      <span class="comment">*&gt;   Runtime defined mathematical equation evaluation
</span>      <span class="comment">*&gt; TECTONICS
</span>      <span class="comment">*&gt;   cobc -b cobweb-math.cob wrapmath.c -lmatheval -lreadline
</span>      <span class="comment">*&gt; ***************************************************************
</span>       <span class="keyword reserved">identification</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">program-id</span><span class="punctuation">.</span> <span class="name variable">cobweb-math</span><span class="punctuation">.</span>
       <span class="name variable">author</span><span class="punctuation">.</span> <span class="name variable">Brian</span> <span class="name variable">Tiffin</span><span class="punctuation">.</span>
       <span class="name variable">date-written</span><span class="punctuation">.</span> <span class="literal number integer">2016</span><span class="operator">-</span><span class="literal number integer">07</span><span class="operator">-</span><span class="literal number integer">15</span><span class="operator">/</span><span class="literal number integer">10</span><span class="punctuation">:</span><span class="literal number integer">20</span><span class="operator">-</span><span class="literal number integer">0400</span><span class="punctuation">.</span>
       <span class="name variable">date-modified</span><span class="punctuation">.</span> <span class="literal number integer">2016</span><span class="operator">-</span><span class="literal number integer">07</span><span class="operator">-</span><span class="literal number integer">23</span><span class="operator">/</span><span class="literal number integer">17</span><span class="punctuation">:</span><span class="literal number integer">09</span><span class="operator">-</span><span class="literal number integer">0400</span><span class="punctuation">.</span>
       <span class="name variable">date-compiled</span><span class="punctuation">.</span>
       <span class="name variable">installation</span><span class="punctuation">.</span>
       <span class="name variable">remarks</span><span class="punctuation">.</span>
       <span class="name variable">security</span><span class="punctuation">.</span>

       <span class="keyword reserved">environment</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">configuration</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="keyword pseudo">source-computer</span><span class="punctuation">.</span> <span class="name variable">gnulinux</span><span class="punctuation">.</span>
       <span class="keyword pseudo">object-computer</span><span class="punctuation">.</span> <span class="name variable">gnulinux</span>
           <span class="error">classification</span> <span class="keyword pseudo">is</span> <span class="name variable">canadian</span><span class="punctuation">.</span>

       <span class="keyword pseudo">special-names</span><span class="punctuation">.</span>
           <span class="keyword pseudo">locale</span> <span class="name variable">canadian</span> <span class="keyword pseudo">is </span><span class="literal string double">&quot;en_CA.UTF-8&quot;</span><span class="punctuation">.</span>

       <span class="keyword pseudo">repository</span><span class="punctuation">.</span>
           <span class="keyword pseudo">function</span> <span class="name variable">evaluate-math</span>
           <span class="keyword pseudo">function</span> <span class="name variable">create-equation</span>
           <span class="keyword pseudo">function</span> <span class="name variable">evaluate-equation</span>
           <span class="keyword pseudo">function</span> <span class="name variable">destroy-equation</span>
           <span class="keyword pseudo">function</span> <span class="name variable">evaluate-x</span>
           <span class="keyword pseudo">function</span> <span class="keyword pseudo">all</span> <span class="keyword pseudo">intrinsic</span><span class="punctuation">.</span>

       <span class="keyword reserved">data</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">working-storage</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>

       <span class="error">REPLACE </span><span class="operator">==</span><span class="punctuation">:</span><span class="name variable">EVALUATOR-RECORD</span><span class="punctuation">:</span><span class="operator">==</span> <span class="keyword pseudo">BY </span><span class="operator">==</span>
       <span class="literal number integer">01 </span><span class="name variable">evaluator-record</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="name variable">evaluator</span>         <span class="keyword pseudo">usage</span> <span class="keyword pseudo">pointer</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="name variable">evaluator-image</span>   <span class="keyword pseudo">usage</span> <span class="keyword pseudo">pointer</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="name variable">evaluator-prime</span>   <span class="keyword pseudo">usage</span> <span class="keyword pseudo">pointer</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="name variable">prime-image</span>       <span class="keyword pseudo">usage</span> <span class="keyword pseudo">pointer</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="name variable">variable-names</span>    <span class="keyword pseudo">usage</span> <span class="keyword pseudo">pointer</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="name variable">variable-count</span>    <span class="keyword pseudo">usage</span> <span class="keyword type">binary-long</span><span class="punctuation">.</span>
       <span class="operator">==</span><span class="punctuation">.</span>
       <span class="punctuation">:</span><span class="name variable">EVALUATOR-RECORD</span><span class="punctuation">:</span>

       <span class="literal number integer">01 </span><span class="name variable">NAME-LIMIT</span>           <span class="keyword pseudo">constant</span> <span class="keyword pseudo">as</span> <span class="literal number integer">16</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">name-list</span>            <span class="keyword pseudo">based</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="name variable">variable-name</span>     <span class="keyword pseudo">usage</span> <span class="keyword pseudo">pointer</span> <span class="keyword pseudo">occurs</span> <span class="name variable">NAME-LIMIT</span> <span class="keyword pseudo">times</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">value-list</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="name variable">variable-value</span>    <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span> <span class="keyword pseudo">occurs</span> <span class="name variable">NAME-LIMIT</span> <span class="keyword pseudo">times</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">answer</span>               <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>

       <span class="literal number integer">01 </span><span class="name variable">cli</span>                  <span class="keyword type">pic x(80)</span><span class="punctuation">.</span>
          <span class="literal number integer">88 </span><span class="name variable">helping</span>               <span class="keyword pseudo">values </span><span class="literal string double">&quot;help&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;-help&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;--help&quot;</span><span class="punctuation">.</span>
          <span class="literal number integer">88 </span><span class="name variable">demoing</span>               <span class="keyword pseudo">value </span><span class="literal string double">&quot;demo&quot;</span><span class="punctuation">.</span>
          <span class="literal number integer">88 </span><span class="name variable">calcing</span>               <span class="keyword pseudo">value </span><span class="literal string double">&quot;calc&quot;</span><span class="punctuation">.</span>
          <span class="literal number integer">88 </span><span class="name variable">repoing</span>               <span class="keyword pseudo">values </span><span class="literal string double">&quot;repository&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;repo&quot;</span><span class="punctuation">.</span>

       <span class="literal number integer">01 </span><span class="name variable">command-ptr</span>          <span class="keyword pseudo">usage</span> <span class="keyword pseudo">pointer</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">command-buf</span>          <span class="keyword type">pic x(80)</span> <span class="keyword pseudo">based</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">command</span>              <span class="keyword type">pic x(80)</span><span class="punctuation">.</span>
          <span class="literal number integer">88 </span><span class="name variable">quitting</span>              <span class="keyword pseudo">values </span><span class="literal string double">&quot;q&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;quit&quot;</span><span class="punctuation">.</span>
          <span class="literal number integer">88 </span><span class="name variable">replhelp</span>              <span class="keyword pseudo">values </span><span class="literal string double">&quot;h&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;help&quot;</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">last-command</span>         <span class="keyword type">pic x(80)</span><span class="punctuation">.</span>

       <span class="literal number integer">01 </span><span class="name variable">variable</span>             <span class="keyword type">pic x(80)</span><span class="punctuation">.</span>
          <span class="literal number integer">88 </span><span class="name variable">setting</span>               <span class="keyword pseudo">values </span><span class="literal string double">&quot;X&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;x&quot;</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">the-number</span>           <span class="keyword type">pic x(80)</span><span class="punctuation">.</span>
          <span class="literal number integer">88 </span><span class="name variable">want-answer</span>           <span class="keyword pseudo">values </span><span class="literal string double">&quot;ans&quot;</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">got-equal</span>            <span class="keyword type">pic x</span><span class="punctuation">.</span>

       <span class="literal number integer">01 </span><span class="name variable">calculation</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="keyword pseudo">value </span><span class="literal string double">&quot;(1 + 2 * 3 / 4 - 5)^3&quot;</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">equation</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="keyword pseudo">value </span><span class="literal string double">&quot;x^4 + sin(x^2) + 2*x^y + 42&quot;</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">x</span>                    <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span> <span class="keyword pseudo">value</span> <span class="literal number integer">1</span><span class="punctuation">.</span><span class="literal number integer">0</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">y</span>                    <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span> <span class="keyword pseudo">value</span> <span class="literal number integer">1</span><span class="punctuation">.</span><span class="literal number integer">0</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">ans</span>                  <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>

       <span class="literal number integer">01 </span><span class="name variable">extraneous</span>           <span class="keyword pseudo">usage</span> <span class="keyword type">binary-long</span><span class="punctuation">.</span>

      <span class="comment">*&gt; ***************************************************************
</span>       <span class="keyword reserved">procedure</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">accept</span> <span class="name variable">cli</span> <span class="keyword pseudo">from</span> <span class="keyword pseudo">command-line
      </span> <span class="keyword reserved">if</span> <span class="name variable">helping</span> <span class="keyword reserved">then
          </span> <span class="keyword reserved">display </span><span class="literal string double">&quot;cobweb-math: enter equations and get numbers&quot;</span>
           <span class="keyword reserved">display </span><span class="literal string double">&quot;options include: help, demo, repository, [calc]&quot;</span>
           <span class="keyword reserved">goback
      </span> <span class="keyword reserved">end-if

      </span> <span class="keyword reserved">if</span> <span class="name variable">repoing</span> <span class="keyword reserved">then
          </span> <span class="keyword reserved">display </span><span class="literal string double">&quot;       *&gt; Repository for cobweb-math&quot;</span>
           <span class="keyword reserved">display </span><span class="literal string double">&quot;           function create-equation&quot;</span>
           <span class="keyword reserved">display </span><span class="literal string double">&quot;           function evaluate-equation&quot;</span>
           <span class="keyword reserved">display </span><span class="literal string double">&quot;           function destroy-equation&quot;</span>
           <span class="keyword reserved">display </span><span class="literal string double">&quot;           function evaluate-x&quot;</span>
           <span class="keyword reserved">display </span><span class="literal string double">&quot;           function evaluate-x-y&quot;</span>
           <span class="keyword reserved">display </span><span class="literal string double">&quot;           function evaluate-x-y-z&quot;</span>
           <span class="keyword reserved">goback
      </span> <span class="keyword reserved">end-if

      </span> <span class="keyword reserved">if</span> <span class="name variable">demoing</span> <span class="keyword reserved">then
           </span><span class="comment">*&gt; simple math
</span>           <span class="keyword reserved">display </span><span class="literal string double">&quot;cobweb-math internal demo&quot;</span>
           <span class="keyword reserved">display</span> <span class="name variable">calculation</span> <span class="literal string double">&quot; = &quot;</span> <span class="name variable">evaluate-math</span><span class="punctuation">(</span><span class="name variable">calculation</span><span class="punctuation">)</span>
           <span class="keyword reserved">display</span> <span class="name variable">evaluate-math</span><span class="punctuation">(</span><span class="literal string double">&quot;5 +&quot;</span><span class="punctuation">)</span>
           <span class="keyword reserved">display</span> <span class="name constant">space

           </span><span class="comment">*&gt; two variable equation, with derivative
</span>           <span class="keyword reserved">move</span> <span class="name variable">create-equation</span><span class="punctuation">(</span><span class="name variable">equation</span><span class="punctuation">,</span> <span class="literal string double">&quot;derivative, variables&quot;</span><span class="punctuation">)</span>
             <span class="keyword pseudo">to</span> <span class="name variable">evaluator-record</span>

           <span class="keyword reserved">display </span><span class="literal string double">&quot;Given: &quot;</span> <span class="name variable">equation</span>
           <span class="keyword reserved">if</span> <span class="name variable">evaluator-image</span> <span class="operator word">not</span> <span class="operator word">equal</span> <span class="keyword pseudo">null</span> <span class="keyword reserved">then
              </span> <span class="keyword reserved">call </span><span class="literal string double">&quot;printf&quot;</span> <span class="keyword pseudo">using
                  </span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">content </span><span class="literal string double">&quot;seen as :%s: &quot;</span> <span class="punctuation">&amp;</span> <span class="name variable">x</span><span class="literal string double">&quot;0a00&quot;</span>
                   <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">evaluator-image</span>
               <span class="keyword reserved">end-call
          </span> <span class="keyword reserved">end-if

          </span> <span class="keyword reserved">display</span> <span class="name variable">variable-count</span> <span class="literal string double">&quot; variables in equation&quot;</span>
           <span class="keyword reserved">if</span> <span class="name variable">variable-names</span> <span class="operator word">not</span> <span class="operator word">equal</span> <span class="keyword pseudo">null</span> <span class="keyword reserved">then
              </span> <span class="keyword reserved">set</span> <span class="keyword pseudo">address</span> <span class="keyword pseudo">of</span> <span class="name variable">name-list</span> <span class="keyword pseudo">to</span> <span class="name variable">variable-names</span>
               <span class="keyword reserved">display </span><span class="literal string double">&quot;    &quot;</span> <span class="keyword pseudo">with</span> <span class="keyword pseudo">no</span> <span class="keyword pseudo">advancing
              </span> <span class="keyword reserved">perform</span> <span class="keyword pseudo">varying</span> <span class="name variable">tally</span> <span class="keyword pseudo">from</span> <span class="literal number integer">1 </span><span class="keyword pseudo">by</span> <span class="literal number integer">1 </span><span class="keyword pseudo">until
                  </span> <span class="name variable">tally</span> <span class="operator">&gt;</span> <span class="name variable">variable-count</span>
                   <span class="keyword reserved">call </span><span class="literal string double">&quot;printf&quot;</span> <span class="keyword pseudo">using
                      </span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">content</span> <span class="name variable">z</span><span class="literal string double">&quot;%s &quot;</span>
                       <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">variable-name</span><span class="punctuation">(</span><span class="name variable">tally</span><span class="punctuation">)</span>
               <span class="keyword reserved">end-perform
              </span> <span class="keyword reserved">display</span> <span class="name constant">space
          </span> <span class="keyword reserved">end-if
          </span> <span class="keyword reserved">if</span> <span class="name variable">prime-image</span> <span class="operator word">not</span> <span class="operator word">equal</span> <span class="keyword pseudo">null</span> <span class="keyword reserved">then
              </span> <span class="keyword reserved">call </span><span class="literal string double">&quot;printf&quot;</span> <span class="keyword pseudo">using
                  </span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">content </span><span class="literal string double">&quot;with derivative :%s: &quot;</span> <span class="punctuation">&amp;</span> <span class="name variable">x</span><span class="literal string double">&quot;0a00&quot;</span>
                   <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">prime-image</span>
               <span class="keyword reserved">end-call
          </span> <span class="keyword reserved">end-if

          </span> <span class="keyword reserved">move</span> <span class="literal number integer">2</span><span class="punctuation">.</span><span class="literal number integer">0 </span><span class="keyword pseudo">to</span> <span class="name variable">variable-value</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span>
           <span class="keyword reserved">move</span> <span class="literal number integer">8</span><span class="punctuation">.</span><span class="literal number integer">0 </span><span class="keyword pseudo">to</span> <span class="name variable">variable-value</span><span class="punctuation">(</span><span class="literal number integer">2</span><span class="punctuation">)</span>
           <span class="keyword reserved">move</span> <span class="name variable">evaluate-equation</span><span class="punctuation">(</span><span class="name variable">evaluator</span><span class="punctuation">,</span> <span class="name variable">variable-count</span><span class="punctuation">,</span>
                                  <span class="name variable">variable-names</span><span class="punctuation">,</span> <span class="name variable">value-list</span><span class="punctuation">)</span> <span class="keyword pseudo">to</span> <span class="name variable">answer</span>
           <span class="keyword reserved">display </span><span class="literal string double">&quot;f(&quot;</span> <span class="name variable">variable-value</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span> <span class="literal string double">&quot;, &quot;</span> <span class="name variable">variable-value</span><span class="punctuation">(</span><span class="literal number integer">2</span><span class="punctuation">)</span>
                   <span class="literal string double">&quot;)  = &quot;</span> <span class="name variable">answer</span>

           <span class="keyword reserved">move</span> <span class="name variable">evaluate-equation</span><span class="punctuation">(</span><span class="name variable">evaluator-prime</span><span class="punctuation">,</span> <span class="name variable">variable-count</span><span class="punctuation">,</span>
                                  <span class="name variable">variable-names</span><span class="punctuation">,</span> <span class="name variable">value-list</span><span class="punctuation">)</span> <span class="keyword pseudo">to</span> <span class="name variable">answer</span>
           <span class="keyword reserved">display </span><span class="literal string double">&quot;f'(&quot;</span> <span class="name variable">variable-value</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span> <span class="literal string double">&quot;, &quot;</span> <span class="name variable">variable-value</span><span class="punctuation">(</span><span class="literal number integer">2</span><span class="punctuation">)</span>
                   <span class="literal string double">&quot;) = &quot;</span> <span class="name variable">answer</span>

           <span class="keyword reserved">move</span> <span class="literal number integer">0 </span><span class="keyword pseudo">to</span> <span class="name variable">return-code</span>
           <span class="keyword reserved">goback
      </span> <span class="keyword reserved">end-if

      </span><span class="comment">*&gt; throw up a little REPL, setting variable syntax is ... basic
</span>       <span class="keyword reserved">display </span><span class="literal string double">&quot;REPL: x = number (or ans) or equation in relation to x&quot;</span>
       <span class="keyword reserved">display </span><span class="literal string double">&quot;  (using x is optional, basic math is ok too)&quot;</span>
       <span class="keyword reserved">perform</span> <span class="keyword pseudo">until</span> <span class="keyword reserved">exit
          </span> <span class="keyword reserved">call </span><span class="literal string double">&quot;readline&quot;</span> <span class="keyword pseudo">using</span> <span class="name variable">z</span><span class="literal string double">&quot;&gt; &quot;</span> <span class="keyword pseudo">returning</span> <span class="name variable">command-ptr</span>
           <span class="keyword reserved">if</span> <span class="name variable">command-ptr</span> <span class="operator word">equal</span> <span class="keyword pseudo">null</span> <span class="keyword reserved">then</span> <span class="keyword reserved">exit</span> <span class="keyword reserved">perform</span> <span class="keyword reserved">end-if

          </span> <span class="keyword reserved">move</span> <span class="name constant">spaces</span> <span class="keyword pseudo">to</span> <span class="name variable">command</span>
           <span class="keyword reserved">set</span> <span class="keyword pseudo">address</span> <span class="keyword pseudo">of</span> <span class="name variable">command-buf</span> <span class="keyword pseudo">to</span> <span class="name variable">command-ptr</span>
           <span class="keyword reserved">string</span> <span class="name variable">command-buf</span> <span class="keyword pseudo">delimited</span> <span class="keyword pseudo">by</span> <span class="name constant">low-value</span> <span class="keyword pseudo">into</span> <span class="name variable">command</span>
           <span class="keyword reserved">move</span> <span class="name function">lower-case</span><span class="punctuation">(</span><span class="name function">trim</span><span class="punctuation">(</span><span class="name variable">command</span><span class="punctuation">))</span> <span class="keyword pseudo">to</span> <span class="name variable">command</span>
           <span class="keyword reserved">if</span> <span class="name variable">quitting</span> <span class="keyword reserved">then</span> <span class="keyword reserved">exit</span> <span class="keyword reserved">perform</span> <span class="keyword reserved">end-if

          </span> <span class="keyword reserved">if</span> <span class="name variable">command</span> <span class="operator word">not</span> <span class="operator word">equal</span> <span class="name constant">spaces</span> <span class="operator word">and</span> <span class="name variable">last-command</span> <span class="keyword reserved">then
              </span> <span class="keyword reserved">move</span> <span class="name variable">command</span> <span class="keyword pseudo">to</span> <span class="name variable">last-command</span>
               <span class="keyword reserved">call </span><span class="literal string double">&quot;add_history&quot;</span> <span class="keyword pseudo">using</span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">command-ptr</span>
           <span class="keyword reserved">end-if
          </span> <span class="keyword reserved">if</span> <span class="name variable">replhelp</span> <span class="keyword reserved">then
              </span> <span class="keyword reserved">display </span><span class="literal string double">&quot;libmatheval supports: &quot;</span>
               <span class="keyword reserved">display </span><span class="literal string double">&quot;  Constants:&quot;</span>
               <span class="keyword reserved">display </span><span class="literal string double">&quot;    e, log2e, log10e, ln2, ln10, pi, pi_2,&quot;</span>
               <span class="keyword reserved">display </span><span class="literal string double">&quot;    pi_4, 1_pi, 2_pi, 2_sqrtpi, sqrt2, sqrt1_2&quot;</span>
               <span class="keyword reserved">display </span><span class="literal string double">&quot;  Elementary Functions:&quot;</span>
               <span class="keyword reserved">display </span><span class="literal string double">&quot;    exp(x), log, sqrt, sin, cos, tan, cot, sec,&quot;</span>
               <span class="keyword reserved">display </span><span class="literal string double">&quot;    csc, acsc, sinh, cosh, tanh, coth, sech,&quot;</span>
               <span class="keyword reserved">display </span><span class="literal string double">&quot;    csch, asinh, acosh, atanh, acoth, asech,&quot;</span>
               <span class="keyword reserved">display </span><span class="literal string double">&quot;    acsch. abs, step, delta, nandelta, erf&quot;</span>
               <span class="keyword reserved">display </span><span class="literal string double">&quot;  Basic arthimetic:&quot;</span>
               <span class="keyword reserved">display </span><span class="literal string double">&quot;    - (negation), +, -, * , /, ^, (, )&quot;</span>
               <span class="keyword reserved">display </span><span class="literal string double">&quot;  This repl only uses one optional variable, x&quot;</span>
               <span class="keyword reserved">display </span><span class="literal string double">&quot;  x = ans           to put current result in x&quot;</span>
               <span class="keyword reserved">display </span><span class="literal string double">&quot;  q to quit&quot;</span>
               <span class="keyword reserved">exit</span> <span class="keyword reserved">perform</span> <span class="keyword pseudo">cycle
          </span> <span class="keyword reserved">end-if
          </span> <span class="keyword reserved">unstring</span> <span class="name variable">command</span> <span class="keyword pseudo">delimited</span> <span class="keyword pseudo">by </span><span class="literal string double">&quot;=&quot;</span>
               <span class="keyword pseudo">into</span> <span class="name variable">variable</span> <span class="keyword pseudo">delimiter</span> <span class="keyword pseudo">in</span> <span class="name variable">got-equal</span>
                    <span class="name variable">the-number</span>
           <span class="keyword reserved">end-unstring

          </span> <span class="keyword reserved">if</span> <span class="name variable">setting</span> <span class="operator word">and </span><span class="punctuation">(</span><span class="name variable">got-equal</span> <span class="operator word">equal </span><span class="literal string double">&quot;=&quot;</span><span class="punctuation">)</span> <span class="keyword reserved">then
              </span> <span class="keyword reserved">move</span> <span class="name function">lower-case</span><span class="punctuation">(</span><span class="name function">trim</span><span class="punctuation">(</span><span class="name variable">the-number</span><span class="punctuation">))</span> <span class="keyword pseudo">to</span> <span class="name variable">the-number</span>
               <span class="keyword reserved">if</span> <span class="name variable">want-answer</span> <span class="keyword reserved">then
                  </span> <span class="keyword reserved">move</span> <span class="name variable">ans</span> <span class="keyword pseudo">to</span> <span class="name variable">x</span>
               <span class="keyword reserved">else
                  </span> <span class="keyword reserved">move</span> <span class="name function">numval</span><span class="punctuation">(</span><span class="name variable">the-number</span><span class="punctuation">)</span> <span class="keyword pseudo">to</span> <span class="name variable">x</span>
                   <span class="keyword reserved">move</span> <span class="name variable">x</span> <span class="keyword pseudo">to</span> <span class="name variable">ans</span>
               <span class="keyword reserved">end-if
          </span> <span class="keyword reserved">else
              </span> <span class="keyword reserved">move</span> <span class="name variable">create-equation</span><span class="punctuation">(</span><span class="name variable">command</span><span class="punctuation">,</span> <span class="literal string double">&quot;&quot;</span><span class="punctuation">)</span> <span class="keyword pseudo">to</span> <span class="name variable">evaluator-record</span>
               <span class="keyword reserved">move</span> <span class="name variable">evaluate-x</span><span class="punctuation">(</span><span class="name variable">evaluator</span><span class="punctuation">,</span> <span class="name variable">x</span><span class="punctuation">)</span> <span class="keyword pseudo">to</span> <span class="name variable">ans</span>
               <span class="keyword reserved">move</span> <span class="name variable">destroy-equation</span><span class="punctuation">(</span><span class="name variable">evaluator-record</span><span class="punctuation">)</span> <span class="keyword pseudo">to</span> <span class="name variable">extraneous</span>
           <span class="keyword reserved">end-if
          </span> <span class="keyword reserved">display</span> <span class="name constant">space</span> <span class="name variable">ans</span>

       <span class="keyword reserved">end-perform

      </span> <span class="keyword reserved">move</span> <span class="literal number integer">0 </span><span class="keyword pseudo">to</span> <span class="name variable">return-code</span>
       <span class="keyword reserved">goback</span><span class="punctuation">.</span>

      <span class="comment">*&gt; ***************************************************************
</span>
       <span class="error">REPLACE</span> <span class="keyword pseudo">ALSO </span><span class="operator">==</span><span class="punctuation">:</span><span class="name variable">EXCEPTION-HANDLERS</span><span class="punctuation">:</span><span class="operator">==</span> <span class="keyword pseudo">BY
       </span><span class="operator">==</span>
      <span class="comment">*&gt; informational warnings and abends
</span>       <span class="name variable">soft-exception</span><span class="punctuation">.</span>
         <span class="keyword reserved">display</span> <span class="name constant">space</span> <span class="keyword pseudo">upon</span> <span class="name variable">syserr</span>
         <span class="keyword reserved">display </span><span class="literal string double">&quot;--Exception Report-- &quot;</span> <span class="keyword pseudo">upon</span> <span class="name variable">syserr</span>
         <span class="keyword reserved">display </span><span class="literal string double">&quot;Time of exception:   &quot;</span> <span class="name function">current-date</span> <span class="keyword pseudo">upon</span> <span class="name variable">syserr</span>
         <span class="keyword reserved">display </span><span class="literal string double">&quot;Module:              &quot;</span> <span class="name variable">module-id</span> <span class="keyword pseudo">upon</span> <span class="name variable">syserr</span>
         <span class="keyword reserved">display </span><span class="literal string double">&quot;Module-path:         &quot;</span> <span class="name variable">module-path</span> <span class="keyword pseudo">upon</span> <span class="name variable">syserr</span>
         <span class="keyword reserved">display </span><span class="literal string double">&quot;Module-source:       &quot;</span> <span class="name variable">module-source</span> <span class="keyword pseudo">upon</span> <span class="name variable">syserr</span>
         <span class="keyword reserved">display </span><span class="literal string double">&quot;Exception-file:      &quot;</span> <span class="name function">exception-file</span> <span class="keyword pseudo">upon</span> <span class="name variable">syserr</span>
         <span class="keyword reserved">display </span><span class="literal string double">&quot;Exception-status:    &quot;</span> <span class="name function">exception-status</span> <span class="keyword pseudo">upon</span> <span class="name variable">syserr</span>
         <span class="keyword reserved">display </span><span class="literal string double">&quot;Exception-location:  &quot;</span> <span class="name function">exception-location</span> <span class="keyword pseudo">upon</span> <span class="name variable">syserr</span>
         <span class="keyword reserved">display </span><span class="literal string double">&quot;Exception-statement: &quot;</span> <span class="name function">exception-statement</span> <span class="keyword pseudo">upon</span> <span class="name variable">syserr</span>
       <span class="punctuation">.</span>

       <span class="name variable">hard-exception</span><span class="punctuation">.</span>
           <span class="keyword reserved">perform</span> <span class="name variable">soft-exception</span>
           <span class="keyword reserved">stop</span> <span class="keyword pseudo">run</span> <span class="keyword pseudo">returning</span> <span class="literal number integer">127
       </span><span class="punctuation">.</span>
       <span class="operator">==</span><span class="punctuation">.</span>

       <span class="punctuation">:</span><span class="name variable">EXCEPTION-HANDLERS</span><span class="punctuation">:</span>

       <span class="keyword reserved">end</span> <span class="keyword pseudo">program</span> <span class="name variable">cobweb-math</span><span class="punctuation">.</span>
      <span class="comment">*&gt; ***************************************************************
</span>      <span class="comment">*&gt;****
</span>
      <span class="comment">*&gt; ***************************************************************
</span>      <span class="comment">*&gt;****F* cobweb-math/create-equation
</span>       <span class="keyword reserved">identification</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword pseudo">function-id</span><span class="punctuation">.</span> <span class="name variable">create-equation</span><span class="punctuation">.</span>

       <span class="keyword reserved">environment</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">configuration</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="keyword pseudo">repository</span><span class="punctuation">.</span>
           <span class="keyword pseudo">function</span> <span class="keyword pseudo">all</span> <span class="keyword pseudo">intrinsic</span><span class="punctuation">.</span>

       <span class="keyword reserved">data</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">working-storage</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">option-mod</span>           <span class="keyword type">pic x(10)</span><span class="punctuation">.</span>
          <span class="literal number integer">88 </span><span class="name variable">make-derivative</span>       <span class="keyword pseudo">value </span><span class="literal string single">'derivative'</span><span class="punctuation">.</span>
          <span class="literal number integer">88 </span><span class="name variable">get-names</span>             <span class="keyword pseudo">value </span><span class="literal string single">'variables'</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">option-scanner</span>       <span class="keyword pseudo">usage</span> <span class="keyword type">binary-long</span><span class="punctuation">.</span>

       <span class="keyword reserved">linkage</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">equation</span>             <span class="keyword type">pic x</span> <span class="name variable">any</span> <span class="keyword pseudo">length</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">requested-options</span>    <span class="keyword type">pic x</span> <span class="name variable">any</span> <span class="keyword pseudo">length</span><span class="punctuation">.</span>
       <span class="punctuation">:</span><span class="name variable">EVALUATOR-RECORD</span><span class="punctuation">:</span>

       <span class="keyword reserved">procedure</span> <span class="keyword reserved">division</span> <span class="keyword pseudo">using</span> <span class="name variable">equation</span> <span class="name variable">requested-options</span>
           <span class="keyword pseudo">returning</span> <span class="name variable">evaluator-record</span><span class="punctuation">.</span>

      <span class="comment">*&gt; compile given equation
</span>       <span class="keyword reserved">call </span><span class="literal string double">&quot;evaluator_create&quot;</span> <span class="keyword pseudo">using
          </span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">content</span> <span class="name function">concatenate</span><span class="punctuation">(</span><span class="name function">trim</span><span class="punctuation">(</span><span class="name variable">equation</span><span class="punctuation">),</span> <span class="name variable">x</span><span class="literal string double">&quot;00&quot;</span><span class="punctuation">)</span>
           <span class="keyword pseudo">returning</span> <span class="name variable">evaluator</span>
           <span class="keyword pseudo">on</span> <span class="keyword pseudo">exception
              </span> <span class="keyword reserved">display </span><span class="literal string double">&quot;error: cannot initialize evaluator (-lmatheval)&quot;</span>
                  <span class="keyword pseudo">upon</span> <span class="name variable">syserr</span>
               <span class="keyword reserved">perform</span> <span class="name variable">soft-exception</span>
               <span class="keyword reserved">goback
      </span> <span class="keyword reserved">end-call
      </span> <span class="keyword reserved">if</span> <span class="name variable">evaluator</span> <span class="operator word">equal</span> <span class="keyword pseudo">null</span> <span class="keyword reserved">then
          </span> <span class="keyword reserved">display </span><span class="literal string double">&quot;error: could not define &quot;</span> <span class="name function">trim</span><span class="punctuation">(</span><span class="name variable">equation</span><span class="punctuation">)</span>
              <span class="keyword pseudo">upon</span> <span class="name variable">syserr</span>
           <span class="keyword reserved">goback
      </span> <span class="keyword reserved">end-if

      </span><span class="comment">*&gt; get the evaluator view of the equation
</span>       <span class="keyword reserved">call </span><span class="literal string double">&quot;evaluator_get_string&quot;</span> <span class="keyword pseudo">using
          </span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">evaluator</span>
           <span class="keyword pseudo">returning</span> <span class="name variable">evaluator-image</span>
       <span class="keyword reserved">end-call

      </span><span class="comment">*&gt; loop over any options
</span>       <span class="keyword reserved">move</span> <span class="literal number integer">1 </span><span class="keyword pseudo">to</span> <span class="name variable">option-scanner</span>
       <span class="keyword reserved">perform</span> <span class="keyword pseudo">until</span> <span class="name variable">option-scanner</span> <span class="operator">&gt;</span> <span class="keyword pseudo">length</span><span class="punctuation">(</span><span class="name variable">requested-options</span><span class="punctuation">)</span>

           <span class="keyword reserved">unstring</span> <span class="name variable">requested-options</span> <span class="keyword pseudo">delimited</span> <span class="keyword pseudo">by </span><span class="literal string double">&quot;,&quot;</span>
               <span class="keyword pseudo">into</span> <span class="name variable">option-mod</span>
               <span class="keyword pseudo">with</span> <span class="keyword pseudo">pointer</span> <span class="name variable">option-scanner</span>
           <span class="keyword reserved">end-unstring
          </span> <span class="keyword reserved">move</span> <span class="name function">lower-case</span><span class="punctuation">(</span><span class="name function">trim</span><span class="punctuation">(</span><span class="name variable">option-mod</span><span class="punctuation">))</span> <span class="keyword pseudo">to</span> <span class="name variable">option-mod</span>

      <span class="comment">*&gt; let matheval create the first derivative (of x) from equation
</span>           <span class="keyword reserved">if</span> <span class="name variable">make-derivative</span> <span class="keyword reserved">then
              </span> <span class="keyword reserved">call </span><span class="literal string double">&quot;evaluator_derivative_x&quot;</span> <span class="keyword pseudo">using
                  </span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">evaluator</span>
                   <span class="keyword pseudo">returning</span> <span class="name variable">evaluator-prime</span>
               <span class="keyword reserved">end-call

              </span> <span class="keyword reserved">call </span><span class="literal string double">&quot;evaluator_get_string&quot;</span> <span class="keyword pseudo">using
                  </span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">evaluator-prime</span>
                   <span class="keyword pseudo">returning</span> <span class="name variable">prime-image</span>
               <span class="keyword reserved">end-call
          </span> <span class="keyword reserved">end-if

      </span><span class="comment">*&gt; query matheval for the names used inside the equation
</span>           <span class="keyword reserved">if</span> <span class="name variable">get-names</span> <span class="keyword reserved">then
              </span> <span class="keyword reserved">call </span><span class="literal string double">&quot;evaluator_get_variables&quot;</span> <span class="keyword pseudo">using
                  </span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">evaluator</span>
                   <span class="keyword pseudo">by</span> <span class="keyword pseudo">reference</span> <span class="name variable">variable-names</span>
                   <span class="keyword pseudo">by</span> <span class="keyword pseudo">reference</span> <span class="name variable">variable-count</span>
                   <span class="keyword pseudo">returning</span> <span class="keyword pseudo">omitted
              </span> <span class="keyword reserved">end-call
          </span> <span class="keyword reserved">end-if
      </span> <span class="keyword reserved">end-perform

      </span> <span class="keyword reserved">goback</span><span class="punctuation">.</span>

       <span class="punctuation">:</span><span class="name variable">EXCEPTION-HANDLERS</span><span class="punctuation">:</span>

       <span class="keyword reserved">end</span> <span class="keyword pseudo">function</span> <span class="name variable">create-equation</span><span class="punctuation">.</span>
      <span class="comment">*&gt;****
</span>
      <span class="comment">*&gt; ***************************************************************
</span>      <span class="comment">*&gt;****F* cobweb-math/destroy-equation
</span>       <span class="keyword reserved">identification</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword pseudo">function-id</span><span class="punctuation">.</span> <span class="name variable">destroy-equation</span><span class="punctuation">.</span>

       <span class="keyword reserved">environment</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">configuration</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="keyword pseudo">repository</span><span class="punctuation">.</span>
           <span class="keyword pseudo">function</span> <span class="keyword pseudo">all</span> <span class="keyword pseudo">intrinsic</span><span class="punctuation">.</span>

       <span class="keyword reserved">data</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">working-storage</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>

       <span class="keyword reserved">linkage</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="punctuation">:</span><span class="name variable">EVALUATOR-RECORD</span><span class="punctuation">:</span>
       <span class="literal number integer">01 </span><span class="name variable">extraneous</span>           <span class="keyword pseudo">usage</span> <span class="keyword type">binary-long</span><span class="punctuation">.</span>

       <span class="keyword reserved">procedure</span> <span class="keyword reserved">division</span> <span class="keyword pseudo">using</span> <span class="name variable">evaluator-record</span>
           <span class="keyword pseudo">returning</span> <span class="name variable">extraneous</span><span class="punctuation">.</span>

      <span class="comment">*&gt; destroy evaluator(s)
</span>      <span class="comment">*&gt; free up library resources
</span>       <span class="keyword reserved">if</span> <span class="name variable">evaluator</span> <span class="operator word">not</span> <span class="operator word">equal</span> <span class="keyword pseudo">null</span> <span class="keyword reserved">then
          </span> <span class="keyword reserved">call </span><span class="literal string double">&quot;evaluator_destroy&quot;</span> <span class="keyword pseudo">using
              </span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">evaluator</span>
               <span class="keyword pseudo">returning</span> <span class="keyword pseudo">omitted
          </span> <span class="keyword reserved">end-call
      </span> <span class="keyword reserved">end-if
      </span> <span class="keyword reserved">if</span> <span class="name variable">evaluator-prime</span> <span class="operator word">not</span> <span class="operator word">equal</span> <span class="keyword pseudo">null</span> <span class="keyword reserved">then
          </span> <span class="keyword reserved">call </span><span class="literal string double">&quot;evaluator_destroy&quot;</span> <span class="keyword pseudo">using
              </span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">evaluator-prime</span>
               <span class="keyword pseudo">returning</span> <span class="keyword pseudo">omitted
          </span> <span class="keyword reserved">end-call
      </span> <span class="keyword reserved">end-if

      </span> <span class="keyword reserved">move</span> <span class="literal number integer">0 </span><span class="keyword pseudo">to</span> <span class="name variable">extraneous</span>
       <span class="keyword reserved">goback</span><span class="punctuation">.</span>

       <span class="keyword reserved">end</span> <span class="keyword pseudo">function</span> <span class="name variable">destroy-equation</span><span class="punctuation">.</span>
      <span class="comment">*&gt;****
</span>
      <span class="comment">*&gt; ***************************************************************
</span>      <span class="comment">*&gt;****F* cobweb-math/evaluation-equation
</span>       <span class="keyword reserved">identification</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword pseudo">function-id</span><span class="punctuation">.</span> <span class="name variable">evaluate-equation</span><span class="punctuation">.</span>

       <span class="keyword reserved">environment</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">configuration</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="keyword pseudo">repository</span><span class="punctuation">.</span>
           <span class="keyword pseudo">function</span> <span class="keyword pseudo">all</span> <span class="keyword pseudo">intrinsic</span><span class="punctuation">.</span>

       <span class="keyword reserved">data</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">working-storage</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">answer</span>               <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">NAME-LIMIT</span>           <span class="keyword pseudo">constant</span> <span class="keyword pseudo">as</span> <span class="literal number integer">16</span><span class="punctuation">.</span>

       <span class="keyword reserved">linkage</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">given-evaluator</span>      <span class="keyword pseudo">usage</span> <span class="keyword pseudo">pointer</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">given-count</span>          <span class="keyword pseudo">usage</span> <span class="keyword type">binary-long</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">given-names</span>          <span class="keyword pseudo">usage</span> <span class="keyword pseudo">pointer</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">given-values</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="name variable">variable-value</span>    <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span> <span class="keyword pseudo">occurs</span> <span class="name variable">NAME-LIMIT</span> <span class="keyword pseudo">times</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">result</span>               <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>

       <span class="punctuation">:</span><span class="name variable">EVALUATOR-RECORD</span><span class="punctuation">:</span>

       <span class="keyword reserved">procedure</span> <span class="keyword reserved">division</span> <span class="keyword pseudo">using
          </span> <span class="name variable">given-evaluator</span> <span class="name variable">given-count</span> <span class="name variable">given-names</span> <span class="name variable">given-values</span>
           <span class="keyword pseudo">returning</span> <span class="name variable">result</span><span class="punctuation">.</span>

      <span class="comment">*&gt; compile given equation
</span>       <span class="keyword reserved">call </span><span class="literal string double">&quot;evaluate_function&quot;</span> <span class="keyword pseudo">using
          </span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">given-evaluator</span>
           <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">given-count</span>
           <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">given-names</span>
           <span class="keyword pseudo">by</span> <span class="keyword pseudo">reference</span> <span class="name variable">given-values</span>
           <span class="keyword pseudo">by</span> <span class="keyword pseudo">reference</span> <span class="name variable">answer</span>
       <span class="keyword reserved">end-call

      </span> <span class="keyword reserved">move</span> <span class="name variable">answer</span> <span class="keyword pseudo">to</span> <span class="name variable">result</span>
       <span class="keyword reserved">goback</span><span class="punctuation">.</span>

       <span class="punctuation">:</span><span class="name variable">EXCEPTION-HANDLERS</span><span class="punctuation">:</span>

       <span class="keyword reserved">end</span> <span class="keyword pseudo">function</span> <span class="name variable">evaluate-equation</span><span class="punctuation">.</span>
      <span class="comment">*&gt;****
</span>
      <span class="comment">*&gt; ***************************************************************
</span>      <span class="comment">*&gt;****F* cobweb-math/evaluate-math
</span>       <span class="keyword reserved">identification</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword pseudo">function-id</span><span class="punctuation">.</span> <span class="name variable">evaluate-math</span><span class="punctuation">.</span>

       <span class="keyword reserved">environment</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">configuration</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="keyword pseudo">repository</span><span class="punctuation">.</span>
           <span class="keyword pseudo">function</span> <span class="keyword pseudo">all</span> <span class="keyword pseudo">intrinsic</span><span class="punctuation">.</span>

       <span class="keyword reserved">data</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">working-storage</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">ans</span>                  <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">x</span>                    <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span> <span class="keyword pseudo">value</span> <span class="literal number integer">0</span><span class="punctuation">.</span><span class="literal number integer">0</span><span class="punctuation">.</span>

       <span class="punctuation">:</span><span class="name variable">EVALUATOR-RECORD</span><span class="punctuation">:</span>

       <span class="keyword reserved">linkage</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">calculation</span>          <span class="keyword type">pic x</span> <span class="name variable">any</span> <span class="keyword pseudo">length</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">result</span>               <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>

       <span class="keyword reserved">procedure</span> <span class="keyword reserved">division</span> <span class="keyword pseudo">using</span> <span class="name variable">calculation</span> <span class="keyword pseudo">returning</span> <span class="name variable">result</span><span class="punctuation">.</span>

      <span class="comment">*&gt; compile given equation
</span>       <span class="keyword reserved">call </span><span class="literal string double">&quot;evaluator_create&quot;</span> <span class="keyword pseudo">using
          </span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">content</span> <span class="name function">concatenate</span><span class="punctuation">(</span><span class="name function">trim</span><span class="punctuation">(</span><span class="name variable">calculation</span><span class="punctuation">),</span> <span class="name variable">x</span><span class="literal string double">&quot;00&quot;</span><span class="punctuation">)</span>
           <span class="keyword pseudo">returning</span> <span class="name variable">evaluator</span>
           <span class="keyword pseudo">on</span> <span class="keyword pseudo">exception
              </span> <span class="keyword reserved">display </span><span class="literal string double">&quot;error: cannot initialize evaluator (-lmatheval)&quot;</span>
                  <span class="keyword pseudo">upon</span> <span class="name variable">syserr</span>
               <span class="keyword reserved">perform</span> <span class="name variable">soft-exception</span>
               <span class="keyword reserved">goback
      </span> <span class="keyword reserved">end-call
      </span> <span class="keyword reserved">if</span> <span class="name variable">evaluator</span> <span class="operator word">equal</span> <span class="keyword pseudo">null</span> <span class="keyword reserved">then
          </span> <span class="keyword reserved">display </span><span class="literal string double">&quot;error: could not compute &quot;</span> <span class="name function">trim</span><span class="punctuation">(</span><span class="name variable">calculation</span><span class="punctuation">)</span>
              <span class="keyword pseudo">upon</span> <span class="name variable">syserr</span>
           <span class="keyword reserved">goback
      </span> <span class="keyword reserved">else
          </span><span class="comment">*&gt; x is actually unused
</span>           <span class="keyword reserved">call </span><span class="literal string double">&quot;evaluate_x&quot;</span> <span class="keyword pseudo">using
             </span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">evaluator</span>
              <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">x</span>
              <span class="keyword pseudo">by</span> <span class="keyword pseudo">reference</span> <span class="name variable">ans</span>
           <span class="keyword reserved">end-call
      </span> <span class="keyword reserved">end-if

      </span><span class="comment">*&gt; free up library resources
</span>       <span class="keyword reserved">if</span> <span class="name variable">evaluator</span> <span class="operator word">not</span> <span class="operator word">equal</span> <span class="keyword pseudo">null</span> <span class="keyword reserved">then
          </span> <span class="keyword reserved">call </span><span class="literal string double">&quot;evaluator_destroy&quot;</span> <span class="keyword pseudo">using
              </span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">evaluator</span>
               <span class="keyword pseudo">returning</span> <span class="keyword pseudo">omitted
          </span> <span class="keyword reserved">end-call
      </span> <span class="keyword reserved">end-if

      </span> <span class="keyword reserved">move</span> <span class="name variable">ans</span> <span class="keyword pseudo">to</span> <span class="name variable">result</span>
       <span class="keyword reserved">goback</span><span class="punctuation">.</span>

       <span class="punctuation">:</span><span class="name variable">EXCEPTION-HANDLERS</span><span class="punctuation">:</span>

       <span class="keyword reserved">end</span> <span class="keyword pseudo">function</span> <span class="name variable">evaluate-math</span><span class="punctuation">.</span>
      <span class="comment">*&gt;****
</span>
      <span class="comment">*&gt; ***************************************************************
</span>      <span class="comment">*&gt;****F* cobweb-math/evaluate-x
</span>       <span class="keyword reserved">identification</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword pseudo">function-id</span><span class="punctuation">.</span> <span class="name variable">evaluate-x</span><span class="punctuation">.</span>

       <span class="keyword reserved">data</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">working-storage</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">ans</span>                  <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>

       <span class="keyword reserved">linkage</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">given-evaluator</span>      <span class="keyword pseudo">usage</span> <span class="keyword pseudo">pointer</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">x</span>                    <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">result</span>               <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>

       <span class="keyword reserved">procedure</span> <span class="keyword reserved">division</span> <span class="keyword pseudo">using</span> <span class="name variable">given-evaluator</span> <span class="name variable">x</span> <span class="keyword pseudo">returning</span> <span class="name variable">result</span><span class="punctuation">.</span>

       <span class="keyword reserved">if</span> <span class="name variable">given-evaluator</span> <span class="operator word">not</span> <span class="operator word">equal</span> <span class="keyword pseudo">null</span> <span class="keyword reserved">then
          </span> <span class="keyword reserved">call </span><span class="literal string double">&quot;evaluate_x&quot;</span> <span class="keyword pseudo">using
             </span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">given-evaluator</span>
              <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">x</span>
              <span class="keyword pseudo">by</span> <span class="keyword pseudo">reference</span> <span class="name variable">ans</span>
           <span class="keyword reserved">end-call
      </span> <span class="keyword reserved">else
          </span> <span class="keyword reserved">display </span><span class="literal string double">&quot;error: invalid evaluator&quot;</span> <span class="keyword pseudo">upon</span> <span class="name variable">syserr</span>
       <span class="keyword reserved">end-if

      </span> <span class="keyword reserved">move</span> <span class="name variable">ans</span> <span class="keyword pseudo">to</span> <span class="name variable">result</span>
       <span class="keyword reserved">goback</span><span class="punctuation">.</span>
       <span class="keyword reserved">end</span> <span class="keyword pseudo">function</span> <span class="name variable">evaluate-x</span><span class="punctuation">.</span>
      <span class="comment">*&gt;****
</span>
      <span class="comment">*&gt; ***************************************************************
</span>      <span class="comment">*&gt;****F* cobweb-math/evaluate-xy
</span>       <span class="keyword reserved">identification</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword pseudo">function-id</span><span class="punctuation">.</span> <span class="name variable">evaluate-xy</span><span class="punctuation">.</span>

       <span class="keyword reserved">environment</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">configuration</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="keyword pseudo">repository</span><span class="punctuation">.</span>
           <span class="keyword pseudo">function</span> <span class="keyword pseudo">all</span> <span class="keyword pseudo">intrinsic</span><span class="punctuation">.</span>

       <span class="keyword reserved">data</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">working-storage</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">ans</span>                  <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>

       <span class="keyword reserved">linkage</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">given-evaluator</span>      <span class="keyword pseudo">usage</span> <span class="keyword pseudo">pointer</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">x</span>                    <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">y</span>                    <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">result</span>               <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>

       <span class="keyword reserved">procedure</span> <span class="keyword reserved">division</span> <span class="keyword pseudo">using</span> <span class="name variable">given-evaluator</span> <span class="name variable">x</span> <span class="name variable">y</span> <span class="keyword pseudo">returning</span> <span class="name variable">result</span><span class="punctuation">.</span>

       <span class="keyword reserved">if</span> <span class="name variable">given-evaluator</span> <span class="operator word">not</span> <span class="operator word">equal</span> <span class="keyword pseudo">null</span> <span class="keyword reserved">then
          </span> <span class="keyword reserved">call </span><span class="literal string double">&quot;evaluate_xy&quot;</span> <span class="keyword pseudo">using
             </span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">given-evaluator</span>
              <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">x</span> <span class="name variable">y</span>
              <span class="keyword pseudo">by</span> <span class="keyword pseudo">reference</span> <span class="name variable">ans</span>
           <span class="keyword reserved">end-call
      </span> <span class="keyword reserved">else
          </span> <span class="keyword reserved">display </span><span class="literal string double">&quot;error: invalid evaluator&quot;</span> <span class="keyword pseudo">upon</span> <span class="name variable">syserr</span>
       <span class="keyword reserved">end-if

      </span> <span class="keyword reserved">move</span> <span class="name variable">ans</span> <span class="keyword pseudo">to</span> <span class="name variable">result</span>
       <span class="keyword reserved">goback</span><span class="punctuation">.</span>
       <span class="keyword reserved">end</span> <span class="keyword pseudo">function</span> <span class="name variable">evaluate-xy</span><span class="punctuation">.</span>
      <span class="comment">*&gt;****
</span>
      <span class="comment">*&gt; ***************************************************************
</span>      <span class="comment">*&gt;****F* cobweb-math/evaluate-xyz
</span>       <span class="keyword reserved">identification</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword pseudo">function-id</span><span class="punctuation">.</span> <span class="name variable">evaluate-xyz</span><span class="punctuation">.</span>

       <span class="keyword reserved">environment</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">configuration</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="keyword pseudo">repository</span><span class="punctuation">.</span>
           <span class="keyword pseudo">function</span> <span class="keyword pseudo">all</span> <span class="keyword pseudo">intrinsic</span><span class="punctuation">.</span>

       <span class="keyword reserved">data</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">working-storage</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">ans</span>                  <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>

       <span class="keyword reserved">linkage</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">given-evaluator</span>      <span class="keyword pseudo">usage</span> <span class="keyword pseudo">pointer</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">x</span>                    <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">y</span>                    <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">z</span>                    <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">result</span>               <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>

       <span class="keyword reserved">procedure</span> <span class="keyword reserved">division</span> <span class="keyword pseudo">using</span> <span class="name variable">given-evaluator</span> <span class="name variable">x</span> <span class="name variable">y</span> <span class="name variable">z</span> <span class="keyword pseudo">returning</span> <span class="name variable">result</span><span class="punctuation">.</span>

       <span class="keyword reserved">if</span> <span class="name variable">given-evaluator</span> <span class="operator word">not</span> <span class="operator word">equal</span> <span class="keyword pseudo">null</span> <span class="keyword reserved">then
          </span> <span class="keyword reserved">call </span><span class="literal string double">&quot;evaluate_xyz&quot;</span> <span class="keyword pseudo">using
             </span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">given-evaluator</span>
              <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">x</span> <span class="name variable">y</span> <span class="name variable">z</span>
              <span class="keyword pseudo">by</span> <span class="keyword pseudo">reference</span> <span class="name variable">ans</span>
           <span class="keyword reserved">end-call
      </span> <span class="keyword reserved">else
          </span> <span class="keyword reserved">display </span><span class="literal string double">&quot;error: invalid evaluator&quot;</span> <span class="keyword pseudo">upon</span> <span class="name variable">syserr</span>
       <span class="keyword reserved">end-if

      </span> <span class="keyword reserved">move</span> <span class="name variable">ans</span> <span class="keyword pseudo">to</span> <span class="name variable">result</span>
       <span class="keyword reserved">goback</span><span class="punctuation">.</span>
       <span class="keyword reserved">end</span> <span class="keyword pseudo">function</span> <span class="name variable">evaluate-xyz</span><span class="punctuation">.</span>
      <span class="comment">*&gt;****
</span><span class="operator">&gt;&gt;</span><span class="keyword reserved">ELSE
</span><span class="error">!</span><span class="name variable">doc-marker</span><span class="error">!</span>
<span class="operator">===========</span>
<span class="name variable">cobweb-math</span>
<span class="operator">===========</span>

<span class="punctuation">..</span> <span class="name variable">contents</span><span class="punctuation">::</span>

<span class="name variable">Introduction</span>
<span class="operator">------------</span>

<span class="name variable">cobweb-math</span><span class="punctuation">,</span> <span class="name variable">a</span> <span class="name variable">mathematical</span> <span class="name variable">equation</span> <span class="name variable">evaluator</span>

<span class="name variable">Accepts</span> <span class="name variable">equations</span> <span class="keyword pseudo">from</span> <span class="name variable">a</span> <span class="keyword pseudo">character</span> <span class="name variable">field</span> <span class="operator word">and</span> <span class="name variable">a</span> <span class="error">table</span> <span class="keyword pseudo">of</span> <span class="name variable">variable</span> <span class="keyword pseudo">values</span>
<span class="operator word">and</span> <span class="name variable">creates</span> <span class="name variable">an</span> <span class="name variable">evaluator</span><span class="punctuation">,</span> <span class="keyword pseudo">using </span><span class="error">``</span><span class="name variable">libmatheval</span><span class="error">``</span> <span class="name variable">a</span> <span class="name variable">GNU</span> <span class="name variable">project</span><span class="punctuation">.</span>

<span class="name variable">The</span> <span class="name variable">basic</span> <span class="name variable">user</span> <span class="keyword pseudo">function</span> <span class="keyword pseudo">repository</span> <span class="name variable">wraps</span> <span class="error">``</span><span class="name variable">libmatheval</span><span class="error">``</span> <span class="keyword pseudo">for </span><span class="operator">*</span><span class="name variable">somewhat</span><span class="operator">*</span>
<span class="name variable">easy</span> <span class="keyword reserved">use</span> <span class="keyword pseudo">from</span> <span class="name variable">GnuCOBOL</span> <span class="name variable">programs</span><span class="punctuation">.</span>

<span class="name variable">Inputs</span> <span class="operator word">and</span> <span class="keyword reserved">return</span> <span class="keyword pseudo">values</span> <span class="keyword pseudo">are </span><span class="error">``</span><span class="keyword pseudo">float-long</span><span class="error">``</span> <span class="punctuation">(</span><span class="name variable">C</span> <span class="error">``</span><span class="name variable">double</span><span class="error">``</span><span class="punctuation">)</span> <span class="keyword pseudo">type</span><span class="punctuation">.</span>

<span class="keyword pseudo">Repository
</span><span class="punctuation">..........</span>

<span class="name variable">Functions</span> <span class="name variable">include</span><span class="punctuation">:</span>

<span class="operator">-</span> <span class="name variable">create-equation</span><span class="punctuation">(</span><span class="name variable">equation</span><span class="punctuation">,</span> <span class="literal string double">&quot;options&quot;</span><span class="punctuation">)</span> <span class="keyword pseudo">to</span> <span class="name variable">evaluator-record</span>
<span class="operator">-</span> <span class="name variable">evaluate-equation</span><span class="punctuation">(</span><span class="name variable">evaluator</span><span class="punctuation">,</span> <span class="name variable">variable-count</span><span class="punctuation">,</span> <span class="name variable">names</span><span class="punctuation">,</span> <span class="keyword pseudo">values</span><span class="punctuation">)</span> <span class="keyword pseudo">to</span> <span class="name variable">answer</span>
<span class="operator">-</span> <span class="name variable">destroy-equation</span><span class="punctuation">(</span><span class="name variable">evaluator-record</span><span class="punctuation">)</span> <span class="keyword pseudo">to</span> <span class="name variable">extraneous</span>

<span class="error">Options</span> <span class="keyword pseudo">to </span><span class="error">``</span><span class="name variable">create-equation</span><span class="error">``</span> <span class="name variable">include</span> <span class="operator">*</span><span class="name variable">derivative</span><span class="operator">*</span> <span class="operator word">and </span><span class="operator">*</span><span class="name variable">variables</span><span class="operator">*</span> <span class="operator word">and</span>
<span class="name variable">can</span> <span class="name variable">be</span> <span class="name variable">used</span> <span class="keyword pseudo">to</span> <span class="name variable">create</span> <span class="name variable">a</span> <span class="keyword pseudo">first</span> <span class="keyword pseudo">order</span> <span class="name variable">derivative</span> <span class="keyword pseudo">from</span> <span class="name variable">the</span> <span class="name variable">equation</span> <span class="operator word">and</span><span class="operator">/</span><span class="operator word">or</span>
<span class="keyword reserved">return</span> <span class="name variable">the</span> <span class="name variable">list</span> <span class="keyword pseudo">of</span> <span class="name variable">variable</span> <span class="name variable">names</span> <span class="name variable">used</span> <span class="keyword pseudo">in</span> <span class="name variable">the</span> <span class="name variable">equation</span><span class="punctuation">.</span>  <span class="name variable">Upto</span> <span class="literal number integer">16 </span><span class="name variable">named</span>
<span class="name variable">variables</span> <span class="keyword pseudo">are</span> <span class="name variable">supported</span> <span class="keyword pseudo">by </span><span class="error">``</span><span class="name variable">cobweb-math</span><span class="error">``</span><span class="punctuation">.</span>  <span class="error">Options</span> <span class="keyword pseudo">are</span> <span class="name variable">passed</span> <span class="keyword pseudo">as</span> <span class="name variable">a</span>
<span class="keyword pseudo">character</span> <span class="name variable">field</span><span class="punctuation">,</span> <span class="name variable">separated</span> <span class="keyword pseudo">by</span> <span class="name variable">commas</span><span class="punctuation">.</span>

<span class="keyword pseudo">Values</span> <span class="keyword pseudo">are</span> <span class="name variable">held</span> <span class="keyword pseudo">in</span> <span class="name variable">a</span> <span class="error">table</span> <span class="keyword pseudo">of </span><span class="error">``</span><span class="keyword pseudo">float-long</span><span class="error">``</span><span class="punctuation">,</span> <span class="name variable">upto</span> <span class="literal number integer">16</span><span class="punctuation">,</span> <span class="keyword pseudo">corresponding</span> <span class="keyword pseudo">to</span>
<span class="name variable">the</span> <span class="name variable">names</span> <span class="name variable">used</span><span class="punctuation">,</span> <span class="keyword pseudo">first</span> <span class="name variable">name</span> <span class="name variable">encounterd</span> <span class="keyword pseudo">in</span> <span class="name variable">the</span> <span class="name variable">equation</span> <span class="keyword pseudo">is</span> <span class="literal number integer">1</span><span class="punctuation">,</span> <span class="keyword pseudo">next</span> <span class="keyword pseudo">is</span> <span class="literal number integer">2</span><span class="punctuation">,</span>
<span class="operator word">and</span> <span class="name variable">so</span> <span class="keyword pseudo">on</span><span class="punctuation">.</span>  <span class="name variable">Convenience</span> <span class="name variable">functions</span> <span class="name variable">exist</span> <span class="keyword pseudo">for</span> <span class="name variable">equations</span> <span class="name variable">that</span> <span class="keyword reserved">use

</span><span class="error">``</span><span class="name variable">x</span><span class="error">``</span><span class="punctuation">,</span> <span class="error">``</span><span class="name variable">y</span><span class="error">``</span><span class="punctuation">,</span> <span class="operator word">and </span><span class="error">``</span><span class="name variable">z</span><span class="error">``</span> <span class="keyword pseudo">as</span> <span class="name variable">the</span> <span class="name variable">variable</span> <span class="name variable">names</span><span class="punctuation">.</span>

<span class="name variable">Convenience</span> <span class="name variable">functions</span> <span class="name variable">include</span><span class="punctuation">:</span>

<span class="operator">-</span> <span class="name variable">evaluate-math</span><span class="punctuation">(</span><span class="name variable">calculation</span><span class="punctuation">)</span> <span class="keyword pseudo">to</span> <span class="name variable">answer</span>  <span class="punctuation">(</span><span class="keyword pseudo">for</span> <span class="keyword reserved">use</span> <span class="keyword pseudo">as</span> <span class="name variable">a</span> <span class="name variable">calculator</span><span class="punctuation">)</span>
<span class="operator">-</span> <span class="name variable">evaluate-x</span><span class="punctuation">(</span><span class="name variable">evaluator</span><span class="punctuation">,</span> <span class="name variable">x</span><span class="punctuation">)</span> <span class="keyword pseudo">to</span> <span class="name variable">answer</span>
<span class="operator">-</span> <span class="name variable">evaluate-xy</span><span class="punctuation">(</span><span class="name variable">evaluator</span><span class="punctuation">,</span> <span class="name variable">x</span><span class="punctuation">,</span> <span class="name variable">y</span><span class="punctuation">)</span> <span class="keyword pseudo">to</span> <span class="name variable">answer</span>
<span class="operator">-</span> <span class="name variable">evaluate-xyz</span><span class="punctuation">(</span><span class="name variable">evaluator</span><span class="punctuation">,</span> <span class="name variable">x</span><span class="punctuation">,</span> <span class="name variable">y</span><span class="punctuation">,</span> <span class="name variable">z</span><span class="punctuation">)</span> <span class="keyword pseudo">to</span> <span class="name variable">answer</span>

<span class="name variable">Copybook</span>
<span class="punctuation">........</span>
<span class="name variable">There</span> <span class="keyword pseudo">is</span> <span class="name variable">a</span> <span class="name variable">small</span> <span class="error">``</span><span class="name variable">cobweb-math</span><span class="punctuation">.</span><span class="name variable">cpy</span><span class="error">``</span> <span class="name variable">copybook</span> <span class="name variable">that</span> <span class="name variable">ships</span> <span class="keyword pseudo">with
</span><span class="error">``</span><span class="name variable">cobweb-math</span><span class="error">``</span><span class="punctuation">,</span> <span class="name variable">that</span> <span class="name variable">defines</span> <span class="name variable">the</span> <span class="name variable">structure</span> <span class="keyword pseudo">of</span> <span class="name variable">the</span> <span class="error">``</span><span class="name variable">evaluator-record</span><span class="error">``</span><span class="punctuation">.</span>

<span class="name variable">It</span> <span class="name variable">requires</span> <span class="name variable">a</span> <span class="name variable">working</span> <span class="name variable">storage</span> <span class="name variable">name</span> <span class="name variable">prefix</span> <span class="name variable">change</span> <span class="keyword pseudo">before</span> <span class="keyword reserved">use</span><span class="punctuation">.</span>

<span class="punctuation">..</span> <span class="name variable">sourcecode</span><span class="punctuation">::</span> <span class="name variable">cobolfree</span>

    <span class="keyword pseudo">COPY</span> <span class="name variable">cobweb-math</span> <span class="keyword pseudo">REPLACING </span><span class="operator">==</span><span class="punctuation">:</span><span class="name variable">tag</span><span class="punctuation">:</span><span class="operator">==</span> <span class="keyword pseudo">BY </span><span class="operator">==</span><span class="name variable">user-prefix</span><span class="operator">==</span><span class="punctuation">.</span>

<span class="name variable">Where</span> <span class="error">``</span><span class="name variable">user-prefix</span><span class="error">``</span> <span class="keyword pseudo">is</span> <span class="name variable">developer</span> <span class="name variable">choice</span><span class="punctuation">.</span>

<span class="name variable">libmatheval</span>
<span class="punctuation">...........</span>

<span class="name variable">The</span> <span class="name variable">GNU</span> <span class="error">``</span><span class="name variable">libmatheval</span><span class="error">``</span> <span class="name variable">library</span> <span class="name variable">supports</span><span class="punctuation">:</span>

<span class="operator">-</span> <span class="name variable">Constants</span><span class="punctuation">:</span>
    <span class="operator">-</span> <span class="name function">e</span><span class="punctuation">,</span> <span class="name variable">log2e</span><span class="punctuation">,</span> <span class="name variable">log10e</span><span class="punctuation">,</span> <span class="name variable">ln2</span><span class="punctuation">,</span> <span class="name variable">ln10</span><span class="punctuation">,</span> <span class="name function">pi</span><span class="punctuation">,</span> <span class="name variable">pi_2</span><span class="punctuation">,</span>
    <span class="operator">-</span> <span class="name variable">pi_4</span><span class="punctuation">,</span> <span class="literal number integer">1</span><span class="error">_</span><span class="name variable">pi</span><span class="punctuation">,</span> <span class="literal number integer">2</span><span class="error">_</span><span class="name variable">pi</span><span class="punctuation">,</span> <span class="literal number integer">2</span><span class="error">_</span><span class="name variable">sqrtpi</span><span class="punctuation">,</span> <span class="name variable">sqrt2</span><span class="punctuation">,</span> <span class="name variable">sqrt1_2</span>

<span class="operator">-</span> <span class="name variable">Elementary</span> <span class="name variable">Functions</span><span class="punctuation">:</span>
    <span class="operator">-</span> <span class="name function">exp</span><span class="punctuation">(</span><span class="name variable">x</span><span class="punctuation">),</span> <span class="name function">log</span><span class="punctuation">,</span> <span class="name function">sqrt</span><span class="punctuation">,</span> <span class="name function">sin</span><span class="punctuation">,</span> <span class="name function">cos</span><span class="punctuation">,</span> <span class="name function">tan</span><span class="punctuation">,</span> <span class="name variable">cot</span><span class="punctuation">,</span> <span class="name variable">sec</span>
    <span class="operator">-</span> <span class="name variable">csc</span><span class="punctuation">,</span> <span class="name variable">acsc</span><span class="punctuation">,</span> <span class="name variable">sinh</span><span class="punctuation">,</span> <span class="name variable">cosh</span><span class="punctuation">,</span> <span class="name variable">tanh</span><span class="punctuation">,</span> <span class="name variable">coth</span><span class="punctuation">,</span> <span class="name variable">sech</span>
    <span class="operator">-</span> <span class="name variable">csch</span><span class="punctuation">,</span> <span class="name variable">asinh</span><span class="punctuation">,</span> <span class="name variable">acosh</span><span class="punctuation">,</span> <span class="name variable">atanh</span><span class="punctuation">,</span> <span class="name variable">acoth</span><span class="punctuation">,</span> <span class="name variable">asech</span>
    <span class="operator">-</span> <span class="name variable">acsch</span><span class="punctuation">.</span> <span class="name function">abs</span><span class="punctuation">,</span> <span class="error">step</span><span class="punctuation">,</span> <span class="name variable">delta</span><span class="punctuation">,</span> <span class="name variable">nandelta</span><span class="punctuation">,</span> <span class="name variable">erf</span>
<span class="operator">-</span> <span class="name variable">Basic</span> <span class="name variable">arthimetic</span><span class="punctuation">:</span>
    <span class="operator">-</span> <span class="punctuation">(</span><span class="name variable">negation</span><span class="punctuation">),</span> <span class="operator">+</span><span class="punctuation">,</span> <span class="operator">-</span><span class="punctuation">,</span> <span class="operator">*</span> <span class="punctuation">,</span> <span class="operator">/</span><span class="punctuation">,</span> <span class="error">^</span><span class="punctuation">,</span> <span class="punctuation">(,</span> <span class="operator word">and </span><span class="punctuation">)</span>


<span class="name variable">Tectonics</span>
<span class="operator">---------</span>

<span class="name variable">Requires</span><span class="punctuation">:</span>

<span class="error">``</span><span class="name variable">libmatheval</span><span class="error">``</span><span class="punctuation">,</span> <span class="error">``</span><span class="name variable">libmatheval-dev</span><span class="error">``</span><span class="punctuation">,</span>
<span class="error">``</span><span class="name variable">libreadline</span><span class="error">``</span> <span class="operator word">and </span><span class="error">``</span><span class="name variable">libreadline-dev</span><span class="error">``</span>

<span class="punctuation">::</span>

    <span class="keyword pseudo">prompt</span><span class="error">$</span> <span class="name variable">cobc</span> <span class="operator">-</span><span class="name variable">bd</span> <span class="name variable">cobweb-math</span><span class="punctuation">.</span><span class="name variable">cob</span> <span class="name variable">wrapmath</span><span class="punctuation">.</span><span class="name variable">c</span> <span class="operator">-</span><span class="name variable">lmatheval</span> <span class="operator">-</span><span class="name variable">lreadline</span>
    <span class="keyword pseudo">prompt</span><span class="error">$</span> <span class="name variable">cobc</span> <span class="operator">-</span><span class="name variable">x</span> <span class="name variable">user-program</span><span class="punctuation">.</span><span class="name variable">cob</span> <span class="operator">-</span><span class="name variable">l</span><span class="punctuation">:</span><span class="name variable">cobweb-math</span><span class="punctuation">.</span><span class="name variable">so</span> <span class="operator">-</span><span class="name variable">L</span><span class="punctuation">.</span>


<span class="keyword pseudo">Usage</span>
<span class="operator">-----</span>

<span class="punctuation">::</span>

    <span class="keyword pseudo">prompt</span><span class="error">$</span> <span class="name variable">cobcrun</span> <span class="name variable">cobweb-math</span> <span class="name variable">help</span><span class="error">|</span><span class="name variable">demo</span><span class="error">|</span><span class="keyword pseudo">repository</span><span class="error">|[</span><span class="name variable">calc</span><span class="error">]</span>

<span class="error">``</span><span class="name variable">calc</span><span class="error">``</span> <span class="keyword pseudo">is</span> <span class="name variable">the</span> <span class="keyword pseudo">default</span> <span class="keyword pseudo">top</span> <span class="name variable">level</span> <span class="name variable">option</span><span class="punctuation">,</span> <span class="operator word">and</span> <span class="name variable">will</span> <span class="keyword reserved">display</span> <span class="name variable">a</span> <span class="name variable">small</span>
<span class="name variable">calculator</span> <span class="name variable">Read-Evaluate-Print-Loop</span><span class="punctuation">,</span> <span class="name variable">suitable</span> <span class="keyword pseudo">for</span> <span class="name variable">basic</span> <span class="name variable">math</span> <span class="operator word">or</span> <span class="name variable">single</span>
<span class="name variable">variable</span> <span class="name variable">equations</span><span class="punctuation">.</span>  <span class="name variable">The</span> <span class="keyword pseudo">only</span> <span class="name variable">supported</span> <span class="name variable">variable</span> <span class="keyword pseudo">for</span> <span class="name variable">the</span> <span class="name variable">small</span> <span class="error">``</span><span class="name variable">calc</span><span class="error">``</span>
<span class="name variable">engine</span> <span class="keyword pseudo">is </span><span class="error">``</span><span class="name variable">x</span><span class="error">``</span><span class="punctuation">.</span>

<span class="name variable">See</span> <span class="name variable">cobweb-math-demo</span><span class="punctuation">.</span><span class="name variable">cob</span><span class="error">_</span> <span class="keyword pseudo">for</span> <span class="name variable">an</span> <span class="name variable">example</span><span class="punctuation">.</span>  <span class="operator word">And</span> <span class="name variable">the</span> <span class="error">``</span><span class="name variable">calc</span><span class="error">``</span>
<span class="name variable">engine</span> <span class="name variable">inside</span> <span class="error">``</span><span class="name variable">cobweb-math</span><span class="punctuation">.</span><span class="name variable">cob</span><span class="error">``</span> <span class="name variable">itself</span> <span class="keyword pseudo">for</span> <span class="name variable">more</span> <span class="keyword pseudo">usage</span> <span class="name variable">hints</span><span class="punctuation">.</span>

<span class="keyword pseudo">Source</span>
<span class="operator">------</span>

<span class="name variable">Makefile</span>
<span class="punctuation">........</span>

<span class="punctuation">..</span> <span class="name variable">include</span><span class="punctuation">::</span> <span class="name variable">Makefile</span>
   <span class="punctuation">:</span><span class="keyword pseudo">code</span><span class="punctuation">:</span> <span class="name variable">make</span>

<span class="name variable">cobweb-math</span><span class="punctuation">.</span><span class="name variable">cob</span>
<span class="punctuation">...............</span>

<span class="punctuation">..</span> <span class="name variable">include</span><span class="punctuation">::</span> <span class="name variable">cobweb-math</span><span class="punctuation">.</span><span class="name variable">cob</span>
   <span class="punctuation">:</span><span class="keyword pseudo">code</span><span class="punctuation">:</span> <span class="name variable">cobolfree</span>

<span class="name variable">cobweb-math</span><span class="punctuation">.</span><span class="name variable">cpy</span>
<span class="punctuation">...............</span>

<span class="punctuation">..</span> <span class="name variable">include</span><span class="punctuation">::</span> <span class="name variable">cobweb-math</span><span class="punctuation">.</span><span class="name variable">cpy</span>
   <span class="punctuation">:</span><span class="keyword pseudo">code</span><span class="punctuation">:</span> <span class="name variable">cobolfree</span>

<span class="name variable">wrapmath</span><span class="punctuation">.</span><span class="name variable">c</span>
<span class="punctuation">..........</span>

<span class="punctuation">..</span> <span class="name variable">include</span><span class="punctuation">::</span> <span class="name variable">wrapmath</span><span class="punctuation">.</span><span class="name variable">c</span>
   <span class="punctuation">:</span><span class="keyword pseudo">code</span><span class="punctuation">:</span> <span class="name variable">c</span>

<span class="name variable">cobweb-math-demo</span><span class="punctuation">.</span><span class="name variable">cob</span>
<span class="punctuation">....................</span>

<span class="punctuation">..</span> <span class="name variable">include</span><span class="punctuation">::</span> <span class="name variable">cobweb-math-demo</span><span class="punctuation">.</span><span class="name variable">cob</span>
   <span class="punctuation">:</span><span class="keyword pseudo">code</span><span class="punctuation">:</span> <span class="name variable">cobolfree</span>

<span class="name variable">Subject</span> <span class="keyword pseudo">to</span> <span class="name variable">change</span><span class="punctuation">,</span> <span class="name variable">but</span> <span class="name variable">that</span> <span class="name variable">produces</span>

<span class="punctuation">..</span> <span class="name variable">include</span><span class="punctuation">::</span> <span class="name variable">cobweb-math-demo</span><span class="punctuation">.</span><span class="name variable">out</span>
   <span class="punctuation">:</span><span class="name variable">literal</span><span class="punctuation">:</span>
<span class="operator">&gt;&gt;</span><span class="keyword reserved">END-IF</span>
</pre>
</div>
<div class="section" id="cobweb-math-cpy">
<h2><a class="toc-backref" href="#id10">cobweb-math.cpy</a></h2>
<pre class="code cobolfree literal-block">
       <span class="literal number integer">01 </span><span class="punctuation">:</span><span class="name variable">tag</span><span class="punctuation">:</span><span class="name variable">evaluator-record</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="punctuation">:</span><span class="name variable">tag</span><span class="punctuation">:</span><span class="name variable">evaluator</span>         <span class="keyword pseudo">usage</span> <span class="keyword pseudo">pointer</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="punctuation">:</span><span class="name variable">tag</span><span class="punctuation">:</span><span class="name variable">evaluator-image</span>   <span class="keyword pseudo">usage</span> <span class="keyword pseudo">pointer</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="punctuation">:</span><span class="name variable">tag</span><span class="punctuation">:</span><span class="name variable">evaluator-prime</span>   <span class="keyword pseudo">usage</span> <span class="keyword pseudo">pointer</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="punctuation">:</span><span class="name variable">tag</span><span class="punctuation">:</span><span class="name variable">prime-image</span>       <span class="keyword pseudo">usage</span> <span class="keyword pseudo">pointer</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="punctuation">:</span><span class="name variable">tag</span><span class="punctuation">:</span><span class="name variable">variable-names</span>    <span class="keyword pseudo">usage</span> <span class="keyword pseudo">pointer</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="punctuation">:</span><span class="name variable">tag</span><span class="punctuation">:</span><span class="name variable">variable-count</span>    <span class="keyword pseudo">usage</span> <span class="keyword type">binary-long</span><span class="punctuation">.</span>

       <span class="literal number integer">01 </span><span class="punctuation">:</span><span class="name variable">tag</span><span class="punctuation">:</span><span class="name variable">NAME-LIMIT</span>           <span class="keyword pseudo">constant</span> <span class="keyword pseudo">as</span> <span class="literal number integer">16</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="punctuation">:</span><span class="name variable">tag</span><span class="punctuation">:</span><span class="name variable">name-list</span>            <span class="keyword pseudo">based</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="punctuation">:</span><span class="name variable">tag</span><span class="punctuation">:</span><span class="name variable">variable-name</span>     <span class="keyword pseudo">usage</span> <span class="keyword pseudo">pointer
                                  </span> <span class="keyword pseudo">occurs </span><span class="punctuation">:</span><span class="name variable">tag</span><span class="punctuation">:</span><span class="name variable">NAME-LIMIT</span> <span class="keyword pseudo">times</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="punctuation">:</span><span class="name variable">tag</span><span class="punctuation">:</span><span class="name variable">value-list</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="punctuation">:</span><span class="name variable">tag</span><span class="punctuation">:</span><span class="name variable">variable-value</span>    <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long
                                  </span> <span class="keyword pseudo">occurs </span><span class="punctuation">:</span><span class="name variable">tag</span><span class="punctuation">:</span><span class="name variable">NAME-LIMIT</span> <span class="keyword pseudo">times</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="punctuation">:</span><span class="name variable">tag</span><span class="punctuation">:</span><span class="name variable">lme-result</span>           <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>
</pre>
</div>
<div class="section" id="wrapmath-c">
<h2><a class="toc-backref" href="#id11">wrapmath.c</a></h2>
<pre class="code c literal-block">
<span class="comment multiline">/*
* Evaluate math expressions with libmatheval
* wrappers place the double return values in references passed from GnuCOBOL
*/</span>

<span class="comment preproc">#include</span> <span class="comment preprocfile">&lt;stdio.h&gt;</span><span class="comment preproc">
#include</span> <span class="comment preprocfile">&lt;matheval.h&gt;</span><span class="comment preproc">
</span>
<span class="comment multiline">/* evaluate a function with one variable */</span>
<span class="keyword type">int</span>
<span class="name function">evaluate_x</span><span class="punctuation">(</span><span class="keyword type">void</span> <span class="operator">*</span><span class="name">f</span><span class="punctuation">,</span> <span class="keyword type">double</span> <span class="name">x</span><span class="punctuation">,</span> <span class="keyword type">double</span> <span class="operator">*</span><span class="name">ans</span><span class="punctuation">)</span>
<span class="punctuation">{</span>
    <span class="operator">*</span><span class="name">ans</span> <span class="operator">=</span> <span class="name">evaluator_evaluate_x</span><span class="punctuation">(</span><span class="name">f</span><span class="punctuation">,</span> <span class="name">x</span><span class="punctuation">);</span>
    <span class="keyword">return</span> <span class="literal number integer">0</span><span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="comment multiline">/* evaluate a function with two variables */</span>
<span class="keyword type">int</span>
<span class="name function">evaluate_xy</span><span class="punctuation">(</span><span class="keyword type">void</span> <span class="operator">*</span><span class="name">f</span><span class="punctuation">,</span> <span class="keyword type">double</span> <span class="name">x</span><span class="punctuation">,</span> <span class="keyword type">double</span> <span class="name">y</span><span class="punctuation">,</span> <span class="keyword type">double</span> <span class="operator">*</span><span class="name">ans</span><span class="punctuation">)</span>
<span class="punctuation">{</span>
    <span class="operator">*</span><span class="name">ans</span> <span class="operator">=</span> <span class="name">evaluator_evaluate_x_y</span><span class="punctuation">(</span><span class="name">f</span><span class="punctuation">,</span> <span class="name">x</span><span class="punctuation">,</span> <span class="name">y</span><span class="punctuation">);</span>
    <span class="keyword">return</span> <span class="literal number integer">0</span><span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="comment multiline">/* evaluate a function with three variables */</span>
<span class="keyword type">int</span>
<span class="name function">evaluate_xyz</span><span class="punctuation">(</span><span class="keyword type">void</span> <span class="operator">*</span><span class="name">f</span><span class="punctuation">,</span> <span class="keyword type">double</span> <span class="name">x</span><span class="punctuation">,</span> <span class="keyword type">double</span> <span class="name">y</span><span class="punctuation">,</span> <span class="keyword type">double</span> <span class="name">z</span><span class="punctuation">,</span> <span class="keyword type">double</span> <span class="operator">*</span><span class="name">ans</span><span class="punctuation">)</span>
<span class="punctuation">{</span>
    <span class="operator">*</span><span class="name">ans</span> <span class="operator">=</span> <span class="name">evaluator_evaluate_x_y_z</span><span class="punctuation">(</span><span class="name">f</span><span class="punctuation">,</span> <span class="name">x</span><span class="punctuation">,</span> <span class="name">y</span><span class="punctuation">,</span> <span class="name">z</span><span class="punctuation">);</span>
    <span class="keyword">return</span> <span class="literal number integer">0</span><span class="punctuation">;</span>
<span class="punctuation">}</span>

<span class="comment multiline">/*
* evaluate a function given arbitrary variables, using the data names returned
* from evaluator_get_variables
*/</span>
<span class="keyword type">int</span>
<span class="name function">evaluate_function</span><span class="punctuation">(</span><span class="keyword type">void</span> <span class="operator">*</span><span class="name">f</span><span class="punctuation">,</span> <span class="keyword type">int</span> <span class="name">vars</span><span class="punctuation">,</span> <span class="keyword type">char</span> <span class="operator">**</span><span class="name">names</span><span class="punctuation">,</span> <span class="keyword type">double</span> <span class="operator">*</span><span class="name">values</span><span class="punctuation">,</span> <span class="keyword type">double</span> <span class="operator">*</span><span class="name">ans</span><span class="punctuation">)</span>
<span class="punctuation">{</span>
    <span class="operator">*</span><span class="name">ans</span> <span class="operator">=</span> <span class="name">evaluator_evaluate</span><span class="punctuation">(</span><span class="name">f</span><span class="punctuation">,</span> <span class="name">vars</span><span class="punctuation">,</span> <span class="name">names</span><span class="punctuation">,</span> <span class="name">values</span><span class="punctuation">);</span>
    <span class="keyword">return</span> <span class="literal number integer">0</span><span class="punctuation">;</span>
<span class="punctuation">}</span>
</pre>
</div>
<div class="section" id="cobweb-math-demo-cob">
<h2><a class="toc-backref" href="#id12">cobweb-math-demo.cob</a></h2>
<pre class="code cobolfree literal-block">
       <span class="keyword reserved">identification</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">program-id</span><span class="punctuation">.</span> <span class="name variable">cobweb-math-demo</span><span class="punctuation">.</span>

       <span class="keyword reserved">environment</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">configuration</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="keyword pseudo">repository</span><span class="punctuation">.</span>
           <span class="keyword pseudo">function</span> <span class="name variable">create-equation</span>
           <span class="keyword pseudo">function</span> <span class="name variable">evaluate-equation</span>
           <span class="keyword pseudo">function</span> <span class="name variable">evaluate-math</span>
           <span class="keyword pseudo">function</span> <span class="name variable">destroy-equation</span>
           <span class="keyword pseudo">function</span> <span class="keyword pseudo">all</span> <span class="keyword pseudo">intrinsic</span><span class="punctuation">.</span>

       <span class="keyword reserved">data</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="keyword reserved">working-storage</span> <span class="keyword reserved">section</span><span class="punctuation">.</span>
       <span class="keyword pseudo">COPY</span> <span class="name variable">cobweb-math</span> <span class="keyword pseudo">REPLACING </span><span class="operator">==</span><span class="punctuation">:</span><span class="name variable">tag</span><span class="punctuation">:</span><span class="operator">==</span> <span class="keyword pseudo">by </span><span class="operator">==</span><span class="name variable">demo</span><span class="operator">-==</span><span class="punctuation">.</span>

       <span class="literal number integer">01 </span><span class="name variable">x</span>                    <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">ans</span>                  <span class="keyword pseudo">usage</span> <span class="keyword pseudo">float-long</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">extraneous</span>           <span class="keyword pseudo">usage</span> <span class="keyword type">binary-long</span><span class="punctuation">.</span>

       <span class="literal number integer">01 </span><span class="name variable">calculation</span><span class="punctuation">.</span>
          <span class="literal number integer">05 </span><span class="keyword pseudo">value </span><span class="literal string double">&quot;(1 + 2 * 3 / 4 - 5)^6&quot;</span><span class="punctuation">.</span>

       <span class="literal number integer">01 </span><span class="name variable">equation</span>             <span class="keyword type">pic x(40)</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">show-input</span>           <span class="keyword type">pic +9.99</span><span class="punctuation">.</span>
       <span class="literal number integer">01 </span><span class="name variable">show-y-input</span>         <span class="keyword type">pic 9.99</span><span class="punctuation">.</span>

       <span class="keyword reserved">procedure</span> <span class="keyword reserved">division</span><span class="punctuation">.</span>
       <span class="name variable">demo-main</span><span class="punctuation">.</span>

      <span class="comment">*&gt; some simple math
</span>       <span class="keyword reserved">display </span><span class="literal string double">&quot;cobweb-math (libmatheval) demonstration&quot;</span>

       <span class="keyword reserved">display</span> <span class="name variable">calculation</span> <span class="literal string double">&quot; = &quot;</span> <span class="name variable">evaluate-math</span><span class="punctuation">(</span><span class="name variable">calculation</span><span class="punctuation">)</span>
       <span class="keyword reserved">display</span> <span class="name constant">space

      </span><span class="comment">*&gt; a more complex example
</span>       <span class="keyword reserved">move </span><span class="literal string double">&quot;x^2 * sin(x) + 42&quot;</span> <span class="keyword pseudo">to</span> <span class="name variable">equation</span>
       <span class="keyword reserved">perform</span> <span class="name variable">show-equation-x</span>

       <span class="keyword reserved">display</span> <span class="name constant">space
      </span> <span class="keyword reserved">move </span><span class="literal string double">&quot;x^2 + 2 * y^3&quot;</span> <span class="keyword pseudo">to</span> <span class="name variable">equation</span>
       <span class="keyword reserved">perform</span> <span class="name variable">show-equation-xy</span>

       <span class="keyword reserved">move</span> <span class="literal number integer">0 </span><span class="keyword pseudo">to</span> <span class="name variable">return-code</span>
       <span class="keyword reserved">goback
       </span><span class="punctuation">.</span>


       <span class="name variable">show-equation-x</span><span class="punctuation">.</span>
       <span class="keyword reserved">move</span> <span class="name variable">create-equation</span><span class="punctuation">(</span><span class="name variable">equation</span><span class="punctuation">,</span> <span class="literal string double">&quot;derivative,variables&quot;</span><span class="punctuation">)</span>
         <span class="keyword pseudo">to</span> <span class="name variable">demo-evaluator-record</span>

       <span class="keyword reserved">display </span><span class="literal string double">&quot; f(x) = &quot;</span> <span class="keyword pseudo">with</span> <span class="keyword pseudo">no</span> <span class="keyword pseudo">advancing
      </span> <span class="keyword reserved">call </span><span class="literal string double">&quot;printf&quot;</span> <span class="keyword pseudo">using </span><span class="literal string double">&quot;%s&quot;</span> <span class="punctuation">&amp;</span> <span class="name variable">x</span><span class="literal string double">&quot;0a00&quot;</span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">demo-evaluator-image</span>

       <span class="keyword reserved">display </span><span class="literal string double">&quot;f'(x) = &quot;</span> <span class="keyword pseudo">with</span> <span class="keyword pseudo">no</span> <span class="keyword pseudo">advancing
      </span> <span class="keyword reserved">call </span><span class="literal string double">&quot;printf&quot;</span> <span class="keyword pseudo">using </span><span class="literal string double">&quot;%s&quot;</span> <span class="punctuation">&amp;</span> <span class="name variable">x</span><span class="literal string double">&quot;0a0a00&quot;</span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">demo-prime-image</span>

       <span class="keyword reserved">perform</span> <span class="keyword pseudo">varying</span> <span class="name variable">demo-variable-value</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span> <span class="keyword pseudo">from</span> <span class="operator">-</span><span class="literal number integer">1</span><span class="punctuation">.</span><span class="literal number integer">0 </span><span class="keyword pseudo">by</span> <span class="literal number integer">0</span><span class="punctuation">.</span><span class="literal number integer">5
           </span><span class="keyword pseudo">until</span> <span class="name variable">demo-variable-value</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span> <span class="operator">&gt;</span> <span class="literal number integer">2</span><span class="punctuation">.</span><span class="literal number integer">0
           </span><span class="keyword reserved">perform</span> <span class="name variable">x-equation</span>
       <span class="keyword reserved">end-perform

      </span> <span class="keyword reserved">move</span> <span class="name variable">destroy-equation</span><span class="punctuation">(</span><span class="name variable">demo-evaluator-record</span><span class="punctuation">)</span> <span class="keyword pseudo">to</span> <span class="name variable">extraneous</span>
       <span class="punctuation">.</span>

      <span class="comment">*&gt; calculate the equation and it's first derivative
</span>       <span class="name variable">x-equation</span><span class="punctuation">.</span>
       <span class="keyword reserved">move</span> <span class="name variable">demo-variable-value</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span> <span class="keyword pseudo">to</span> <span class="name variable">show-input</span>
       <span class="keyword reserved">move</span> <span class="name variable">evaluate-equation</span><span class="punctuation">(</span><span class="name variable">demo-evaluator</span><span class="punctuation">,</span> <span class="name variable">demo-variable-count</span><span class="punctuation">,</span>
                              <span class="name variable">demo-variable-names</span><span class="punctuation">,</span> <span class="name variable">demo-value-list</span><span class="punctuation">)</span>
         <span class="keyword pseudo">to</span> <span class="name variable">ans</span>
       <span class="keyword reserved">display </span><span class="literal string double">&quot; f(&quot;</span> <span class="name variable">show-input</span> <span class="literal string double">&quot;) = &quot;</span> <span class="name variable">ans</span>

       <span class="keyword reserved">move</span> <span class="name variable">evaluate-equation</span><span class="punctuation">(</span><span class="name variable">demo-evaluator-prime</span><span class="punctuation">,</span> <span class="name variable">demo-variable-count</span><span class="punctuation">,</span>
                              <span class="name variable">demo-variable-names</span><span class="punctuation">,</span> <span class="name variable">demo-value-list</span><span class="punctuation">)</span>
         <span class="keyword pseudo">to</span> <span class="name variable">ans</span>
       <span class="keyword reserved">display </span><span class="literal string double">&quot;f'(&quot;</span> <span class="name variable">show-input</span> <span class="literal string double">&quot;) = &quot;</span> <span class="name variable">ans</span>
       <span class="punctuation">.</span>

      <span class="comment">*&gt; an x,y equation example
</span>       <span class="name variable">show-equation-xy</span><span class="punctuation">.</span>
       <span class="keyword reserved">move</span> <span class="name variable">create-equation</span><span class="punctuation">(</span><span class="name variable">equation</span><span class="punctuation">,</span> <span class="literal string double">&quot;derivative,variables&quot;</span><span class="punctuation">)</span>
         <span class="keyword pseudo">to</span> <span class="name variable">demo-evaluator-record</span>

       <span class="keyword reserved">display </span><span class="literal string double">&quot; f(x, y) = &quot;</span> <span class="keyword pseudo">with</span> <span class="keyword pseudo">no</span> <span class="keyword pseudo">advancing
      </span> <span class="keyword reserved">call </span><span class="literal string double">&quot;printf&quot;</span> <span class="keyword pseudo">using </span><span class="literal string double">&quot;%s&quot;</span> <span class="punctuation">&amp;</span> <span class="name variable">x</span><span class="literal string double">&quot;0a00&quot;</span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">demo-evaluator-image</span>

       <span class="keyword reserved">display </span><span class="literal string double">&quot;f'(x, y) = &quot;</span> <span class="keyword pseudo">with</span> <span class="keyword pseudo">no</span> <span class="keyword pseudo">advancing
      </span> <span class="keyword reserved">call </span><span class="literal string double">&quot;printf&quot;</span> <span class="keyword pseudo">using </span><span class="literal string double">&quot;%s&quot;</span> <span class="punctuation">&amp;</span> <span class="name variable">x</span><span class="literal string double">&quot;0a0a00&quot;</span> <span class="keyword pseudo">by</span> <span class="keyword pseudo">value</span> <span class="name variable">demo-prime-image</span>

      <span class="comment">*&gt; set y to 3, vary x
</span>       <span class="keyword reserved">perform</span> <span class="keyword pseudo">varying</span> <span class="name variable">demo-variable-value</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span> <span class="keyword pseudo">from</span> <span class="operator">-</span><span class="literal number integer">1</span><span class="punctuation">.</span><span class="literal number integer">0 </span><span class="keyword pseudo">by</span> <span class="literal number integer">0</span><span class="punctuation">.</span><span class="literal number integer">5
           </span><span class="keyword pseudo">until</span> <span class="name variable">demo-variable-value</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span> <span class="operator">&gt;</span> <span class="literal number integer">1</span><span class="punctuation">.</span><span class="literal number integer">0
           </span><span class="keyword pseudo">after</span> <span class="name variable">demo-variable-value</span><span class="punctuation">(</span><span class="literal number integer">2</span><span class="punctuation">)</span> <span class="keyword pseudo">from</span> <span class="literal number integer">3</span><span class="punctuation">.</span><span class="literal number integer">0 </span><span class="keyword pseudo">by</span> <span class="literal number integer">1</span><span class="punctuation">.</span><span class="literal number integer">0
               </span><span class="keyword pseudo">until</span> <span class="name variable">demo-variable-value</span><span class="punctuation">(</span><span class="literal number integer">2</span><span class="punctuation">)</span> <span class="operator">&gt;</span> <span class="literal number integer">4</span><span class="punctuation">.</span><span class="literal number integer">0
           </span><span class="keyword reserved">perform</span> <span class="name variable">xy-equation</span>
       <span class="keyword reserved">end-perform

      </span> <span class="keyword reserved">move</span> <span class="name variable">destroy-equation</span><span class="punctuation">(</span><span class="name variable">demo-evaluator-record</span><span class="punctuation">)</span> <span class="keyword pseudo">to</span> <span class="name variable">extraneous</span>
       <span class="punctuation">.</span>

      <span class="comment">*&gt; calculate the x,y equation and it's first derivative
</span>       <span class="name variable">xy-equation</span><span class="punctuation">.</span>
       <span class="keyword reserved">move</span> <span class="name variable">demo-variable-value</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span> <span class="keyword pseudo">to</span> <span class="name variable">show-input</span>
       <span class="keyword reserved">move</span> <span class="name variable">demo-variable-value</span><span class="punctuation">(</span><span class="literal number integer">2</span><span class="punctuation">)</span> <span class="keyword pseudo">to</span> <span class="name variable">show-y-input</span>
       <span class="keyword reserved">move</span> <span class="name variable">evaluate-equation</span><span class="punctuation">(</span><span class="name variable">demo-evaluator</span><span class="punctuation">,</span> <span class="name variable">demo-variable-count</span><span class="punctuation">,</span>
                              <span class="name variable">demo-variable-names</span><span class="punctuation">,</span> <span class="name variable">demo-value-list</span><span class="punctuation">)</span>
         <span class="keyword pseudo">to</span> <span class="name variable">ans</span>
       <span class="keyword reserved">display </span><span class="literal string double">&quot; f(&quot;</span> <span class="name variable">show-input</span> <span class="literal string double">&quot;, &quot;</span> <span class="name variable">show-y-input</span> <span class="literal string double">&quot;) = &quot;</span> <span class="name variable">ans</span>

       <span class="keyword reserved">move</span> <span class="name variable">evaluate-equation</span><span class="punctuation">(</span><span class="name variable">demo-evaluator-prime</span><span class="punctuation">,</span> <span class="name variable">demo-variable-count</span><span class="punctuation">,</span>
                              <span class="name variable">demo-variable-names</span><span class="punctuation">,</span> <span class="name variable">demo-value-list</span><span class="punctuation">)</span>
         <span class="keyword pseudo">to</span> <span class="name variable">ans</span>
       <span class="keyword reserved">display </span><span class="literal string double">&quot;f'(&quot;</span> <span class="name variable">show-input</span> <span class="literal string double">&quot;, &quot;</span> <span class="name variable">show-y-input</span> <span class="literal string double">&quot;) = &quot;</span> <span class="name variable">ans</span>
       <span class="punctuation">.</span>

       <span class="keyword reserved">end</span> <span class="keyword pseudo">program</span> <span class="name variable">cobweb-math-demo</span><span class="punctuation">.</span>
</pre>
<p>Subject to change, but that produces</p>
<pre class="literal-block">
cobweb-math (libmatheval) demonstration
(1 + 2 * 3 / 4 - 5)^6 = 244.140625
 
 f(x) = (((x^2)*sin(x))+42)
f'(x) = (((2*x)*sin(x))+((x^2)*cos(x)))

 f(-1.00) = 41.1585290151921
f'(-1.00) = 2.223244275483933
 f(-0.50) = 41.88014361534895
f'(-0.50) = 0.6988211790767962
 f(+0.00) = 42
f'(+0.00) = 0
 f(+0.50) = 42.11985638465105
f'(+0.50) = 0.6988211790767962
 f(+1.00) = 42.8414709848079
f'(+1.00) = 2.223244275483933
 f(+1.50) = 44.24436371985912
f'(+1.50) = 3.151643663564495
 f(+2.00) = 45.63718970730272
f'(+2.00) = 1.972602361114157
 
 f(x, y) = ((x^2)+(2*(y^3)))
f'(x, y) = ((2*x)+((0*(y^3))+(2*(0*(y^2)))))

 f(-1.00, 3.00) = 55
f'(-1.00, 3.00) = -2
 f(-1.00, 4.00) = 129
f'(-1.00, 4.00) = -2
 f(-0.50, 3.00) = 54.25
f'(-0.50, 3.00) = -1
 f(-0.50, 4.00) = 128.25
f'(-0.50, 4.00) = -1
 f(+0.00, 3.00) = 54
f'(+0.00, 3.00) = 0
 f(+0.00, 4.00) = 128
f'(+0.00, 4.00) = 0
 f(+0.50, 3.00) = 54.25
f'(+0.50, 3.00) = 1
 f(+0.50, 4.00) = 128.25
f'(+0.50, 4.00) = 1
 f(+1.00, 3.00) = 55
f'(+1.00, 3.00) = 2
 f(+1.00, 4.00) = 129
f'(+1.00, 4.00) = 2

</pre>
</div>
</div>
</div>
</body>
</html>
